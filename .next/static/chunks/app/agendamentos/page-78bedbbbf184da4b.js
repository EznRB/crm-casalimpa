(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[539],{1092:function(e,t,r){Promise.resolve().then(r.bind(r,9052))},4241:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(1066).Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},518:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(1066).Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},9832:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(1066).Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},4697:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(1066).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},9052:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return k}});var a=r(7437),s=r(2265),n=r(8493),d=r(4316),l=r(518),i=r(1066);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,i.Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);var c=r(4697);function m(){let[e,t]=(0,s.useState)([]),[r,i]=(0,s.useState)(new Date),[m,g]=(0,s.useState)(!0),[x,u]=(0,s.useState)(null),[h,b]=(0,s.useState)(!1),[y,p]=(0,s.useState)(!1),[f,v]=(0,s.useState)([]),[k,j]=(0,s.useState)(!1),[N,w]=(0,s.useState)([]),[_,S]=(0,s.useState)([]),[C,D]=(0,s.useState)(""),[E,M]=(0,s.useState)(""),[Z,A]=(0,s.useState)(""),[I,O]=(0,s.useState)(0),[F,T]=(0,s.useState)(""),[U,Y]=(0,s.useState)(!1),[L,P]=(0,s.useState)({}),[z,q]=(0,s.useState)(null),[H,J]=(0,s.useState)(""),[B,R]=(0,s.useState)({}),[Q,V]=(0,s.useState)({});(0,s.useEffect)(()=>{X()},[r]);let X=async()=>{try{let e=await (0,n.fg)(),a=new Date(r.getFullYear(),r.getMonth(),1),s=new Date(r.getFullYear(),r.getMonth()+1,0),d=(e||[]).filter(e=>{let t=new Date(e.appointment_date),r=new Date("".concat(t.toISOString().slice(0,10),"T00:00:00Z"));return r>=new Date(a.toISOString().slice(0,10))&&r<=new Date(s.toISOString().slice(0,10))});t(d);let l=Array.from(new Set(d.map(e=>e.series_id).filter(Boolean)));P({});let i=["bg-indigo-300","bg-purple-300","bg-pink-300","bg-teal-300","bg-blue-300","bg-orange-300","bg-lime-300","bg-rose-300"],o={},c=Array.from(new Set(e.map(e=>e.customer_id))),m={};c.forEach((e,t)=>{m[e]=i[t%i.length]}),l.forEach(e=>{o[e]={start:0,end:0,color:i[0]}}),e.forEach(e=>{if(!e.series_id)return;let t=Number(e.appointment_date.split("-")[2]),r=o[e.series_id]||{start:t,end:t,color:m[e.customer_id]||i[0]};r.start=0===r.start?t:Math.min(r.start,t),r.end=Math.max(r.end,t),r.color=m[e.customer_id]||r.color,o[e.series_id]=r}),R(o);let g={};e.forEach(e=>{e.series_id&&!g[e.series_id]&&(g[e.series_id]=e.customers.name||e.services.name)}),V(g)}finally{g(!1)}};(0,s.useEffect)(()=>{(async()=>{let e=await (0,n.OL)(),t=(await (0,n.U2)()).filter(e=>e.active);w(e.map(e=>({id:e.id,name:e.name}))),S(t.map(e=>({id:e.id,name:e.name,base_price:e.base_price,duration_minutes:e.duration_minutes})))})()},[]),(0,s.useEffect)(()=>{let e=_.find(e=>e.id===E);e&&O(e.base_price)},[E,_]);let $=t=>{let a="".concat(r.getFullYear(),"-").concat(String(r.getMonth()+1).padStart(2,"0"),"-").concat(String(t).padStart(2,"0"));return e.filter(e=>e.appointment_date===a)},G=e=>({scheduled:"bg-yellow-200 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-100",confirmed:"bg-blue-200 text-blue-800 dark:bg-blue-900 dark:text-blue-100","in-progress":"bg-orange-200 text-orange-800 dark:bg-orange-900 dark:text-orange-100",in_progress:"bg-orange-200 text-orange-800 dark:bg-orange-900 dark:text-orange-100",completed:"bg-green-200 text-green-800 dark:bg-green-900 dark:text-green-100",cancelled:"bg-red-200 text-red-800 dark:bg-red-900 dark:text-red-100"})[e]||"bg-gray-200 text-gray-800 dark:bg-gray-700 dark:text-gray-100",K=e=>{let t=new Date(r.getFullYear(),r.getMonth(),e),a=new Date;return a.setHours(0,0,0,0),t<a},W=e=>{let t=$(e).length;return K(e)?{label:"Indispon\xedvel",cls:"bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-200"}:0===t?{label:"Dispon\xedvel",cls:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100"}:{label:"Agendado",cls:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-100"}},ee=e=>{let t=$(e).length;return K(e)?"border-gray-300 opacity-70":0===t?"border-green-300":"border-yellow-300"},et=e=>Array.from(new Set($(e).map(e=>e.series_id).filter(Boolean))).map(e=>({id:e,range:B[e],label:Q[e]})).filter(e=>e.range),er=e=>{K(e)||(u(e),b(!0))},ea=()=>{b(!1),u(null)},es=e=>{K(e)||v(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e].sort((e,t)=>e-t))},en=()=>{j(!1),D(""),M(""),A(""),O(0),T("")},ed=e=>"".concat(r.getFullYear(),"-").concat(String(r.getMonth()+1).padStart(2,"0"),"-").concat(String(e).padStart(2,"0")),el=async e=>{if(e.preventDefault(),!Z||0===f.length)return alert("Preencha os campos e selecione dias");Y(!0);let t=(null==z?void 0:z.seriesId)||("undefined"!=typeof crypto&&crypto.randomUUID?crypto.randomUUID():"".concat(Date.now(),"-").concat(Math.random())),r=ed(Math.min(...f)),a=H||ed(Math.max(...f));if(!(null==z?void 0:z.seriesId)){if(!C||!E)return Y(!1),alert("Selecione cliente e servi\xe7o");if(!d.O)return Y(!1),alert("Supabase n\xe3o configurado");let{error:e}=await d.O.from("appointment_series").insert({id:t,customer_id:C,service_id:E,start_date:r,estimated_end_date:a,status:"in_progress",notes:F||null});if(e)return Y(!1),alert("Erro ao criar s\xe9rie")}for(let e of f)try{var s,l;await (0,n.Pc)({customer_id:(null==z?void 0:z.customerId)||C,service_id:(null==z?void 0:z.serviceId)||E,appointment_date:ed(e),appointment_time:(null==z?void 0:z.time)||Z,status:"scheduled",price:null!==(s=null==z?void 0:z.price)&&void 0!==s?s:I,notes:null!==(l=null==z?void 0:z.notes)&&void 0!==l?l:F||null})}catch(e){return Y(!1),alert("Erro ao salvar agendamento")}Y(!1),alert("Agendamentos criados com sucesso"),v([]),j(!1),q(null),J(""),X()};return m?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[(0,a.jsx)("button",{onClick:()=>{i(new Date(r.getFullYear(),r.getMonth()-1,1))},className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full",children:(0,a.jsx)(l.Z,{className:"h-5 w-5"})}),(0,a.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:[["Janeiro","Fevereiro","Mar\xe7o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"][r.getMonth()]," ",r.getFullYear()]}),(0,a.jsx)("button",{onClick:()=>{i(new Date(r.getFullYear(),r.getMonth()+1,1))},className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full",children:(0,a.jsx)(o,{className:"h-5 w-5"})})]}),(0,a.jsxs)("div",{className:"p-3 flex items-center gap-3",children:[(0,a.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Legenda:"}),(0,a.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100",children:"Dispon\xedvel"}),(0,a.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-100",children:"Agendado"}),(0,a.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-200",children:"Indispon\xedvel"}),(0,a.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>{p(e=>!e),v([])},className:"px-3 py-1.5 rounded border text-sm ".concat(y?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300"),children:y?"Selecionando dias":"Selecionar dias"}),(0,a.jsx)("button",{onClick:()=>v([]),className:"px-3 py-1.5 rounded border text-sm bg-white text-gray-700 border-gray-300",children:"Limpar sele\xe7\xe3o"}),(0,a.jsx)("button",{onClick:()=>{0!==f.length&&j(!0)},disabled:!y||0===f.length,className:"px-3 py-1.5 rounded border text-sm ".concat(f.length>0&&y?"bg-green-600 text-white border-green-600":"bg-white text-gray-400 border-gray-200"),children:"Agendar selecionados"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-7 gap-px bg-gray-200 dark:bg-gray-700",children:[["Dom","Seg","Ter","Qua","Qui","Sex","S\xe1b"].map(e=>(0,a.jsx)("div",{className:"bg-gray-50 dark:bg-gray-900 p-3 text-center text-sm font-medium text-gray-700 dark:text-gray-300",children:e},e)),(()=>{let e=r.getFullYear(),t=r.getMonth(),a=new Date(e,t,1),s=new Date(e,t+1,0).getDate(),n=a.getDay(),d=[];for(let e=0;e<n;e++)d.push(null);for(let e=1;e<=s;e++)d.push(e);return d})().map((e,t)=>{let r=e?$(e):[];return(0,a.jsx)("div",{className:"relative bg-white dark:bg-gray-800 p-2 min-h-24 border ".concat(e?"".concat(ee(e)," hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer"):"border-gray-100 dark:border-gray-700"),onClick:()=>{e&&(y?es(e):er(e))},children:e&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mb-1",children:e}),(0,a.jsx)("div",{className:"absolute top-2 right-2",children:(()=>{let t=W(e);return(0,a.jsx)("span",{className:"text-xs px-2 py-0.5 rounded-full ".concat(t.cls),children:t.label})})()}),(0,a.jsxs)("div",{className:"space-y-1 ".concat(f.includes(e)?"ring-2 ring-blue-400 rounded p-1":""),children:[et(e).slice(0,2).map((t,r)=>(0,a.jsx)("div",{className:"h-4 ".concat(t.range.color," flex items-center px-1 text-[10px] text-gray-900 dark:text-gray-100 ").concat(e===t.range.start?"rounded-l-full":""," ").concat(e===t.range.end?"rounded-r-full":""),children:(0,a.jsx)("span",{className:"truncate",children:t.label})},"".concat(t.id,"-").concat(r))),r.slice(0,2).map(e=>(0,a.jsxs)("div",{className:"text-xs px-1 py-0.5 rounded ".concat(G(e.status)),children:[(0,a.jsx)("div",{className:"font-medium truncate",children:e.customers.name}),(0,a.jsx)("div",{className:"truncate",children:e.appointment_time})]},e.id)),r.length>2&&(0,a.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-center",children:["+",r.length-2," mais"]})]})]})},t)})]}),h&&null!==x&&(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:ea}),(0,a.jsxs)("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg shadow-lg w-full max-w-2xl mx-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Detalhes do dia ".concat(String(x).padStart(2,"0"),"/").concat(String(r.getMonth()+1).padStart(2,"0"),"/").concat(r.getFullYear())}),(0,a.jsx)("button",{className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",onClick:ea,children:(0,a.jsx)(c.Z,{className:"h-5 w-5"})})]}),(0,a.jsx)("div",{className:"p-4 max-h-[60vh] overflow-y-auto",children:(()=>{let e=$(x);return 0===e.length?(0,a.jsx)("div",{className:"text-gray-700 dark:text-gray-200",children:"Nenhum agendamento â€” Dispon\xedvel"}):(0,a.jsx)("ul",{className:"space-y-3",children:e.map(e=>(0,a.jsxs)("li",{className:"border border-gray-200 dark:border-gray-700 rounded p-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("div",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:e.customers.name}),(0,a.jsx)("span",{className:"text-[11px] px-2 py-0.5 rounded ".concat(G(e.status)),children:e.status})]}),(0,a.jsxs)("div",{className:"mt-2 grid grid-cols-1 sm:grid-cols-2 gap-2 text-sm text-gray-700 dark:text-gray-200",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Hora:"})," ",e.appointment_time]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Servi\xe7o:"})," ",e.services.name]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Dura\xe7\xe3o:"})," ",e.services.duration_minutes," min"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Pre\xe7o:"})," R$ ",e.price.toFixed(2)]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Telefone:"})," ",e.customers.phone]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Email:"})," ",e.customers.email]})]}),e.notes&&(0,a.jsxs)("div",{className:"mt-2 text-sm text-gray-600 dark:text-gray-300",children:[(0,a.jsx)("span",{className:"font-medium",children:"Observa\xe7\xf5es:"})," ",e.notes]}),e.series_id&&L[e.series_id]&&(0,a.jsxs)("div",{className:"mt-2 text-sm text-gray-700 dark:text-gray-200",children:[(0,a.jsx)("span",{className:"font-medium",children:"Est. t\xe9rmino:"})," ",new Date(L[e.series_id].estimated_end_date||e.appointment_date).toLocaleDateString("pt-BR")]}),(0,a.jsx)("div",{className:"mt-3 flex items-center gap-2",children:(0,a.jsx)("button",{className:"px-3 py-1.5 rounded border text-sm bg-white text-gray-700 border-gray-300",onClick:async()=>{let t=e.series_id;if(!t){if(t="undefined"!=typeof crypto&&crypto.randomUUID?crypto.randomUUID():"".concat(Date.now(),"-").concat(Math.random()),!d.O){alert("Supabase n\xe3o configurado");return}await d.O.from("appointment_series").insert({id:t,customer_id:e.customer_id,service_id:e.service_id,start_date:e.appointment_date,status:"in_progress",notes:e.notes}),await d.O.from("appointments").update({series_id:t}).eq("id",e.id)}q({seriesId:t||void 0,customerId:e.customer_id,serviceId:e.service_id,time:e.appointment_time,price:e.price,notes:e.notes}),p(!0),b(!1)},children:"Adicionar dias \xe0 obra"})})]},e.id))})})()})]})]}),k&&(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:en}),(0,a.jsxs)("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg shadow-lg w-full max-w-xl mx-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:["Agendar ",f.length," dia(s)"]}),(0,a.jsx)("button",{className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",onClick:en,children:(0,a.jsx)(c.Z,{className:"h-5 w-5"})})]}),(0,a.jsxs)("form",{onSubmit:el,className:"p-4 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1",children:"Cliente"}),(0,a.jsxs)("select",{value:C,onChange:e=>D(e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"Selecione um cliente"}),N.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1",children:"Servi\xe7o"}),(0,a.jsxs)("select",{value:E,onChange:e=>M(e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"Selecione um servi\xe7o"}),_.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1",children:"Hora"}),(0,a.jsx)("input",{type:"time",value:Z,onChange:e=>A(e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1",children:"Pre\xe7o"}),(0,a.jsx)("input",{type:"number",step:"0.01",value:I,onChange:e=>O(Number(e.target.value)),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1",children:"Observa\xe7\xf5es"}),(0,a.jsx)("textarea",{value:F,onChange:e=>T(e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",rows:3})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1",children:"Estimativa de t\xe9rmino"}),(0,a.jsx)("input",{type:"date",value:H,onChange:e=>J(e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("button",{type:"submit",disabled:U,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white ".concat(U?"bg-blue-300":"bg-blue-600 hover:bg-blue-700"," focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"),children:U?"Salvando...":"Salvar agendamentos"}),(0,a.jsx)("button",{type:"button",onClick:en,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Cancelar"})]})]})]})]})]})}var g=r(4241);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let x=(0,i.Z)("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);var u=r(2513);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let h=(0,i.Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),b=(0,i.Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);var y=r(9832),p=r(6649),f=r(883),v=r(7138);function k(){let[e,t]=(0,s.useState)("calendar"),[r,d]=(0,s.useState)([]),[l,i]=(0,s.useState)(!0);(0,s.useEffect)(()=>{o()},[]);let o=async()=>{try{let e=(await (0,n.Ts)()||[]).sort((e,t)=>new Date(t.appointment_date).getTime()-new Date(e.appointment_date).getTime()).sort((e,t)=>e.appointment_time.localeCompare(t.appointment_time));d(e)}catch(e){console.error("Erro ao buscar agendamentos:",e),alert("Erro ao carregar agendamentos")}finally{i(!1)}},c=async e=>{if(confirm("Tem certeza que deseja excluir este agendamento?"))try{await (0,n.V2)(e),d(r.filter(t=>t.id!==e)),alert("Agendamento exclu\xeddo com sucesso!")}catch(e){console.error("Erro ao excluir agendamento:",e),alert("Erro ao excluir agendamento")}},k=async e=>{try{let t=await fetch("/api/jobs/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"completed"})});if(!t.ok)throw Error("Falha ao atualizar status");await t.json(),d(t=>t.map(t=>t.id===e?{...t,status:"completed"}:t)),alert("Agendamento marcado como conclu\xeddo")}catch(e){alert("Erro ao marcar como conclu\xeddo")}},j=async e=>{try{let t=await fetch("/api/invoices",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({appointmentId:e.id,subtotal:e.price,tax:0})});if(!t.ok)throw Error("Falha ao criar invoice");await t.json(),alert("Invoice criada com sucesso")}catch(e){alert("Erro ao criar invoice")}},N=e=>{switch(e){case"scheduled":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-100";case"confirmed":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100";case"in_progress":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-100";case"completed":default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-100";case"cancelled":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-100"}},w=e=>{switch(e){case"scheduled":return"Agendado";case"confirmed":return"Confirmado";case"in_progress":return"Em Andamento";case"completed":return"Conclu\xeddo";case"cancelled":return"Cancelado";default:return e}};return l&&"list"===e?(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}):(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"sm:flex sm:items-center sm:justify-between mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold text-gray-900 dark:text-gray-100",children:"Agendamentos"}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"flex bg-gray-100 dark:bg-gray-800 rounded-lg p-1",children:[(0,a.jsxs)("button",{onClick:()=>t("calendar"),className:"px-3 py-1 rounded-md text-sm font-medium ".concat("calendar"===e?"bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"),children:[(0,a.jsx)(g.Z,{className:"h-4 w-4 inline mr-1"}),"Calend\xe1rio"]}),(0,a.jsxs)("button",{onClick:()=>t("list"),className:"px-3 py-1 rounded-md text-sm font-medium ".concat("list"===e?"bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"),children:[(0,a.jsx)(x,{className:"h-4 w-4 inline mr-1"}),"Lista"]})]}),(0,a.jsxs)(v.default,{href:"/agendamentos/novo",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4 mr-1"}),"Novo Agendamento"]})]})]}),"calendar"===e?(0,a.jsx)(m,{}):(0,a.jsx)("div",{className:"bg-white dark:bg-gray-800 shadow overflow-hidden sm:rounded-lg",children:(0,a.jsxs)("div",{className:"flow-root",children:[(0,a.jsx)("ul",{className:"-my-5 divide-y divide-gray-200 dark:divide-gray-700",children:r.map(e=>(0,a.jsx)("li",{className:"py-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-4 px-6",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:e.customers.name}),(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(N(e.status)),children:w(e.status)})]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1 mt-1",children:[(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-400",children:[(0,a.jsx)(g.Z,{className:"flex-shrink-0 mr-1 h-4 w-4 text-gray-400 dark:text-gray-500"}),new Date(e.appointment_date).toLocaleDateString("pt-BR")]}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-400",children:[(0,a.jsx)(h,{className:"flex-shrink-0 mr-1 h-4 w-4 text-gray-400 dark:text-gray-500"}),e.appointment_time]}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-400",children:[(0,a.jsx)(b,{className:"flex-shrink-0 mr-1 h-4 w-4 text-gray-400 dark:text-gray-500"}),e.services.name]}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-400",children:[(0,a.jsx)(y.Z,{className:"flex-shrink-0 mr-1 h-4 w-4 text-gray-400 dark:text-gray-500"}),e.customers.phone]})]}),e.notes&&(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-2",children:e.notes})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)(v.default,{href:"/agendamentos/".concat(e.id,"/editar"),className:"inline-flex items-center px-2.5 py-1.5 border border-gray-300 dark:border-gray-700 shadow-sm text-xs font-medium rounded text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800",children:[(0,a.jsx)(p.Z,{className:"h-3 w-3 mr-1"}),"Editar"]}),"completed"!==e.status&&(0,a.jsx)("button",{onClick:()=>k(e.id),className:"inline-flex items-center px-2.5 py-1.5 border border-green-300 dark:border-green-700 shadow-sm text-xs font-medium rounded text-green-700 dark:text-green-300 bg-white dark:bg-gray-900 hover:bg-green-50 dark:hover:bg-gray-800",children:"Marcar como feito"}),"completed"===e.status&&(0,a.jsx)("button",{onClick:()=>j(e),className:"inline-flex items-center px-2.5 py-1.5 border border-blue-300 dark:border-blue-700 shadow-sm text-xs font-medium rounded text-blue-700 dark:text-blue-300 bg-white dark:bg-gray-900 hover:bg-blue-50 dark:hover:bg-gray-800",children:"Criar Invoice"}),(0,a.jsxs)("button",{onClick:()=>c(e.id),className:"inline-flex items-center px-2.5 py-1.5 border border-red-300 dark:border-red-700 shadow-sm text-xs font-medium rounded text-red-700 dark:text-red-300 bg-white dark:bg-gray-900 hover:bg-red-50 dark:hover:bg-gray-800",children:[(0,a.jsx)(f.Z,{className:"h-3 w-3 mr-1"}),"Excluir"]})]})]})},e.id))}),0===r.length&&(0,a.jsx)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"Nenhum agendamento encontrado"})]})})]})}}},function(e){e.O(0,[46,170,138,436,971,23,744],function(){return e(e.s=1092)}),_N_E=e.O()}]);