(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[223],{4071:function(e,t,a){Promise.resolve().then(a.bind(a,7480))},7480:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return p}});var s=a(7437),n=a(2265),r=a(4316),i=a(4241),c=a(1240),o=a(1077),l=a(2023),d=a(7164),m=a(7776);function p(){let[e,t]=(0,n.useState)({startDate:new Date().toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0],type:"appointments",format:"csv"}),[a,p]=(0,n.useState)(!1),u=async()=>{p(!0);try{let t=new Date(e.startDate),a=new Date(e.endDate);a.setHours(23,59,59,999);let s=[],n="",i=[];switch(e.type){case"appointments":let{data:c}=await r.O.from("appointments").select("\n              *,\n              customer:customers(name, email, phone),\n              service:services(name, price)\n            ").gte("date",t.toISOString()).lte("date",a.toISOString()).order("date",{ascending:!0});s=c||[],n="appointments-".concat(e.startDate,"-to-").concat(e.endDate),i=["Date","Time","Customer","Service","Price","Status","Notes"];break;case"customers":let{data:o}=await r.O.from("customers").select("*").order("name",{ascending:!0});s=o||[],n="customers-".concat(new Date().toISOString().split("T")[0]),i=["Name","Email","Phone","Address","Created Date"];break;case"financial":let{data:l}=await r.O.from("invoices").select("\n              *,\n              appointment:appointments(*, customer:customers(name), service:services(name, price))\n            ").gte("created_at",t.toISOString()).lte("created_at",a.toISOString()).order("created_at",{ascending:!0});s=l||[],n="financial-".concat(e.startDate,"-to-").concat(e.endDate),i=["Date","Invoice #","Customer","Service","Amount","Status"]}"csv"===e.format?h(s,i,n,e.type):x(s,i,n,e.type),m.Am.success("Relat\xf3rio gerado com sucesso!")}catch(e){console.error("Error generating report:",e),m.Am.error("Erro ao gerar relat\xf3rio")}finally{p(!1)}},h=(e,t,a,s)=>{let n=t.join(",")+"\n";e.forEach(e=>{var t,a,r,i,c,o,l;let d=[];switch(s){case"appointments":d=[new Date(e.date).toLocaleDateString("pt-BR"),e.time,(null===(t=e.customer)||void 0===t?void 0:t.name)||"",(null===(a=e.service)||void 0===a?void 0:a.name)||"","R$ ".concat(((null===(r=e.service)||void 0===r?void 0:r.price)||0).toFixed(2)),e.status,e.notes||""];break;case"customers":d=[e.name,e.email,e.phone,e.address||"",new Date(e.created_at).toLocaleDateString("pt-BR")];break;case"financial":d=[new Date(e.created_at).toLocaleDateString("pt-BR"),e.invoice_number,(null===(c=e.appointment)||void 0===c?void 0:null===(i=c.customer)||void 0===i?void 0:i.name)||"",(null===(l=e.appointment)||void 0===l?void 0:null===(o=l.service)||void 0===o?void 0:o.name)||"","R$ ".concat(e.amount.toFixed(2)),e.status]}n+=d.map(e=>'"'.concat(e,'"')).join(",")+"\n"});let r=new Blob([n],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a"),c=URL.createObjectURL(r);i.setAttribute("href",c),i.setAttribute("download","".concat(a,".csv")),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)},x=async(t,a,s,n)=>{try{let r=await fetch("/api/reports/pdf",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:t,headers:a,title:g(n),dateRange:"".concat(e.startDate," to ").concat(e.endDate)})});if(!r.ok)throw Error("Failed to generate PDF");let i=await r.blob(),c=window.URL.createObjectURL(i),o=document.createElement("a");o.href=c,o.download="".concat(s,".pdf"),document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(c)}catch(e){console.error("Error generating PDF:",e),m.Am.error("Erro ao gerar PDF")}},g=e=>{switch(e){case"appointments":return"Relat\xf3rio de Agendamentos";case"customers":return"Relat\xf3rio de Clientes";case"financial":return"Relat\xf3rio Financeiro";default:return"Relat\xf3rio"}};return(0,s.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Relat\xf3rios"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Gere relat\xf3rios personalizados sobre agendamentos, clientes e finan\xe7as"})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo de Relat\xf3rio"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"radio",name:"type",value:"appointments",checked:"appointments"===e.type,onChange:a=>t({...e,type:a.target.value}),className:"mr-2"}),(0,s.jsx)(i.Z,{className:"w-4 h-4 mr-2 text-blue-600"}),(0,s.jsx)("span",{children:"Agendamentos"})]}),(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"radio",name:"type",value:"customers",checked:"customers"===e.type,onChange:a=>t({...e,type:a.target.value}),className:"mr-2"}),(0,s.jsx)(c.Z,{className:"w-4 h-4 mr-2 text-green-600"}),(0,s.jsx)("span",{children:"Clientes"})]}),(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"radio",name:"type",value:"financial",checked:"financial"===e.type,onChange:a=>t({...e,type:a.target.value}),className:"mr-2"}),(0,s.jsx)(o.Z,{className:"w-4 h-4 mr-2 text-purple-600"}),(0,s.jsx)("span",{children:"Financeiro"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Formato"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"radio",name:"format",value:"csv",checked:"csv"===e.format,onChange:a=>t({...e,format:a.target.value}),className:"mr-2"}),(0,s.jsx)(l.Z,{className:"w-4 h-4 mr-2 text-gray-600"}),(0,s.jsx)("span",{children:"CSV"})]}),(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"radio",name:"format",value:"pdf",checked:"pdf"===e.format,onChange:a=>t({...e,format:a.target.value}),className:"mr-2"}),(0,s.jsx)(l.Z,{className:"w-4 h-4 mr-2 text-red-600"}),(0,s.jsx)("span",{children:"PDF"})]})]})]})]}),("appointments"===e.type||"financial"===e.type)&&(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data Inicial"}),(0,s.jsx)("input",{type:"date",value:e.startDate,onChange:a=>t({...e,startDate:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data Final"}),(0,s.jsx)("input",{type:"date",value:e.endDate,onChange:a=>t({...e,endDate:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,s.jsx)("button",{onClick:u,disabled:a,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:a?(0,s.jsx)("span",{children:"Gerando relat\xf3rio..."}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.Z,{className:"w-4 h-4 mr-2"}),"Gerar Relat\xf3rio"]})})]}),(0,s.jsxs)("div",{className:"mt-8 bg-gray-50 rounded-lg p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Tipos de Relat\xf3rios"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"bg-white p-4 rounded-lg",children:[(0,s.jsx)(i.Z,{className:"w-8 h-8 text-blue-600 mb-2"}),(0,s.jsx)("h3",{className:"font-medium text-gray-900",children:"Agendamentos"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Relat\xf3rio detalhado de todos os agendamentos no per\xedodo selecionado"})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded-lg",children:[(0,s.jsx)(c.Z,{className:"w-8 h-8 text-green-600 mb-2"}),(0,s.jsx)("h3",{className:"font-medium text-gray-900",children:"Clientes"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Lista completa de todos os clientes cadastrados"})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded-lg",children:[(0,s.jsx)(o.Z,{className:"w-8 h-8 text-purple-600 mb-2"}),(0,s.jsx)("h3",{className:"font-medium text-gray-900",children:"Financeiro"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Relat\xf3rio financeiro com todas as faturas do per\xedodo"})]})]})]})]})}},4316:function(e,t,a){"use strict";a.d(t,{O:function(){return i}});var s=a(4170);let n="https://hyygforlvwbbdzpctnid.supabase.co",r="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh5eWdmb3JsdndiYmR6cGN0bmlkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMyNjY1NjksImV4cCI6MjA3ODg0MjU2OX0.1ih4fZRYRzg1oqZxAYonDPi5wO2-DHvb7anjcSPWeqs",i="string"==typeof n&&"string"==typeof r&&n.startsWith("https://")&&n.includes(".supabase.co")&&!n.includes("example.supabase.co")&&r.length>20?(0,s.createBrowserClient)(n,r):null}},function(e){e.O(0,[46,170,44,971,23,744],function(){return e(e.s=4071)}),_N_E=e.O()}]);