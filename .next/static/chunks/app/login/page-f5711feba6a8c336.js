(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{249:function(e,a,t){Promise.resolve().then(t.bind(t,1193))},6463:function(e,a,t){"use strict";var r=t(1169);t.o(r,"useParams")&&t.d(a,{useParams:function(){return r.useParams}}),t.o(r,"usePathname")&&t.d(a,{usePathname:function(){return r.usePathname}}),t.o(r,"useRouter")&&t.d(a,{useRouter:function(){return r.useRouter}})},1193:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return o}});var r=t(7437),n=t(2265),i=t(6463),s=t(4316);function o(){let[e,a]=(0,n.useState)(""),[t,o]=(0,n.useState)(""),[l,c]=(0,n.useState)("signin"),[d,u]=(0,n.useState)(!1),[m,p]=(0,n.useState)(""),h=(0,i.useRouter)(),g=async a=>{a.preventDefault(),u(!0),p("");try{if(!s.O){if("admin@local.test"===e&&"admin"===t){let e=new Date(Date.now()+288e5).toUTCString();document.cookie="dev_auth=1; path=/; expires=".concat(e),h.push("/");return}p("Modo offline: use admin@local.test / admin ou configure o Supabase nas vari\xe1veis de ambiente.");return}if("signin"===l){let{data:a,error:r}=await s.O.auth.signInWithPassword({email:e,password:t});if(r){if("admin@local.test"===e&&"admin"===t){let e=new Date(Date.now()+288e5).toUTCString();document.cookie="dev_auth=1; path=/; expires=".concat(e),h.push("/");return}p("Falha no login: "+r.message)}else a.session?h.push("/"):p("Login inv\xe1lido")}else{var r;let{data:a,error:n}=await s.O.auth.signUp({email:e,password:t,options:{emailRedirectTo:"".concat((r="http://192.168.15.42:3001",void 0!==r)?r:window.location.origin,"/auth/callback")}});n?p("Falha no cadastro: "+n.message):p("Cadastro criado. Verifique seu email para confirmar.")}}catch(e){p("Erro inesperado. Tente novamente.")}finally{u(!1)}};(0,n.useEffect)(()=>{var e;let a=!0,t=async()=>{if(!s.O)return;let{data:e}=await s.O.auth.getSession();a&&e.session&&h.replace("/")},{data:r}=null!==(e=null===s.O||void 0===s.O?void 0:s.O.auth.onAuthStateChange(e=>{"SIGNED_IN"===e&&h.replace("/")}))&&void 0!==e?e:{data:null};return t(),()=>{var e;a=!1,null==r||null===(e=r.subscription)||void 0===e||e.unsubscribe()}},[h]);let f=async()=>{u(!0),p("");try{var a;if(!s.O){p("Configura\xe7\xe3o do Supabase ausente. Defina NEXT_PUBLIC_SUPABASE_URL e NEXT_PUBLIC_SUPABASE_ANON_KEY.");return}let{error:t}=await s.O.auth.signInWithOtp({email:e,options:{emailRedirectTo:"".concat((a="http://192.168.15.42:3001",void 0!==a)?a:window.location.origin,"/auth/callback")}});t?p("Erro ao enviar email: "+t.message):p("Email enviado! Verifique sua caixa de entrada.")}catch(e){p("Erro inesperado. Tente novamente.")}finally{u(!1)}};return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Entrar no Casa Limpa CRM"}),(0,r.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Acesse com email e senha ou link m\xe1gico"})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>c("signin"),className:"flex-1 py-2 rounded-md border ".concat("signin"===l?"bg-primary-600 text-white border-primary-600":"bg-white text-gray-700 border-gray-300"),children:"Entrar"}),(0,r.jsx)("button",{onClick:()=>c("signup"),className:"flex-1 py-2 rounded-md border ".concat("signup"===l?"bg-primary-600 text-white border-primary-600":"bg-white text-gray-700 border-gray-300"),children:"Criar conta"})]}),(0,r.jsxs)("form",{className:"mt-4 space-y-4",onSubmit:g,children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,r.jsx)("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:e,onChange:e=>a(e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"seu@email.com"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Senha"}),(0,r.jsx)("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:t,onChange:e=>o(e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"••••••••"})]}),m&&(0,r.jsx)("div",{className:"text-sm text-center p-3 rounded-md ".concat(m.includes("Erro")||m.includes("Falha")?"bg-red-50 text-red-800":"bg-green-50 text-green-800"),children:m}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("button",{type:"submit",disabled:d||!s.O,className:"w-full py-2 px-4 text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:"signin"===l?d?"Entrando...":"Entrar":d?"Criando...":"Criar conta"}),(0,r.jsx)("button",{type:"button",onClick:f,disabled:d||!e||!s.O,className:"w-full py-2 px-4 text-sm font-medium rounded-md border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Enviar link m\xe1gico por email"})]})]})]})})}},4316:function(e,a,t){"use strict";t.d(a,{O:function(){return s}});var r=t(4170);let n="https://hyygforlvwbbdzpctnid.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh5eWdmb3JsdndiYmR6cGN0bmlkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMyNjY1NjksImV4cCI6MjA3ODg0MjU2OX0.1ih4fZRYRzg1oqZxAYonDPi5wO2-DHvb7anjcSPWeqs",s="string"==typeof n&&"string"==typeof i&&n.startsWith("https://")&&n.includes(".supabase.co")&&!n.includes("example.supabase.co")&&i.length>20?(0,r.createBrowserClient)(n,i):null}},function(e){e.O(0,[46,170,971,23,744],function(){return e(e.s=249)}),_N_E=e.O()}]);