(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[517],{5711:function(e,t,r){Promise.resolve().then(r.bind(r,4331))},1066:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(2265),o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),a=(e,t)=>{let r=(0,n.forwardRef)((r,a)=>{let{color:s="currentColor",size:c=24,strokeWidth:u=2,absoluteStrokeWidth:l,className:f="",children:d,...m}=r;return(0,n.createElement)("svg",{ref:a,...o,width:c,height:c,stroke:s,strokeWidth:l?24*Number(u)/Number(c):u,className:["lucide","lucide-".concat(i(e)),f].join(" "),...m},[...t.map(e=>{let[t,r]=e;return(0,n.createElement)(t,r)}),...Array.isArray(d)?d:[d]])});return r.displayName="".concat(e),r}},5137:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(1066).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},9061:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(1066).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},6463:function(e,t,r){"use strict";var n=r(1169);r.o(n,"useParams")&&r.d(t,{useParams:function(){return n.useParams}}),r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}})},4331:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l}});var n=r(7437),o=r(2265),i=r(6463),a=r(7138),s=r(8493),c=r(5137),u=r(9061);function l(){let e=(0,i.useRouter)(),[t,r]=(0,o.useState)(!1),[l,f]=(0,o.useState)({name:"",description:"",base_price:"",duration_minutes:"",category:"",is_active:!0}),d=async t=>{t.preventDefault(),r(!0);try{await (0,s.G6)({name:l.name,description:l.description||null,base_price:parseFloat(l.base_price),duration_minutes:parseInt(l.duration_minutes),active:l.is_active}),alert("Servi\xe7o criado com sucesso!"),e.push("/servicos")}catch(e){console.error("Erro ao criar servi\xe7o:",e),alert("Erro ao criar servi\xe7o")}finally{r(!1)}},m=e=>{let{name:t,value:r,type:n}=e.target;f(o=>({...o,[t]:"checkbox"===n?e.target.checked:r}))};return(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)(a.default,{href:"/servicos",className:"p-2 hover:bg-gray-100 rounded-lg",children:(0,n.jsx)(c.Z,{className:"w-5 h-5"})}),(0,n.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Novo Servi\xe7o"})]}),(0,n.jsxs)("form",{onSubmit:d,className:"bg-white rounded-lg shadow p-6 space-y-6",children:[(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome do Servi\xe7o *"}),(0,n.jsx)("input",{type:"text",name:"name",required:!0,value:l.name,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ex: Limpeza Residencial"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Categoria *"}),(0,n.jsxs)("select",{name:"category",required:!0,value:l.category,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,n.jsx)("option",{value:"",children:"Selecione uma categoria"}),(0,n.jsx)("option",{value:"Limpeza Residencial",children:"Limpeza Residencial"}),(0,n.jsx)("option",{value:"Limpeza Comercial",children:"Limpeza Comercial"}),(0,n.jsx)("option",{value:"Limpeza P\xf3s-Obra",children:"Limpeza P\xf3s-Obra"}),(0,n.jsx)("option",{value:"Limpeza de Vidros",children:"Limpeza de Vidros"}),(0,n.jsx)("option",{value:"Limpeza de Carpetes",children:"Limpeza de Carpetes"}),(0,n.jsx)("option",{value:"Limpeza de Sof\xe1s",children:"Limpeza de Sof\xe1s"}),(0,n.jsx)("option",{value:"Higieniza\xe7\xe3o",children:"Higieniza\xe7\xe3o"}),(0,n.jsx)("option",{value:"Outros",children:"Outros"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pre\xe7o Base (R$) *"}),(0,n.jsx)("input",{type:"number",name:"base_price",required:!0,step:"0.01",min:"0",value:l.base_price,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dura\xe7\xe3o (minutos) *"}),(0,n.jsx)("input",{type:"number",name:"duration_minutes",required:!0,min:"30",step:"30",value:l.duration_minutes,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"120"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descri\xe7\xe3o"}),(0,n.jsx)("textarea",{name:"description",rows:3,value:l.description,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Descreva os detalhes do servi\xe7o..."})]}),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("input",{type:"checkbox",id:"is_active",name:"is_active",checked:l.is_active,onChange:m,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,n.jsx)("label",{htmlFor:"is_active",className:"ml-2 block text-sm text-gray-900",children:"Servi\xe7o ativo"})]}),(0,n.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,n.jsx)(a.default,{href:"/servicos",className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancelar"}),(0,n.jsxs)("button",{type:"submit",disabled:t,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center gap-2",children:[(0,n.jsx)(u.Z,{className:"w-4 h-4"}),t?"Salvando...":"Salvar Servi\xe7o"]})]})]})]})}},8493:function(e,t,r){"use strict";r.d(t,{$J:function(){return x},A9:function(){return I},BX:function(){return v},By:function(){return y},CF:function(){return h},FG:function(){return d},G6:function(){return u},HG:function(){return k},J5:function(){return C},KB:function(){return E},LA:function(){return i},OL:function(){return o},Ol:function(){return L},Ov:function(){return f},P6:function(){return q},Pc:function(){return b},Pg:function(){return l},QR:function(){return P},Rt:function(){return z},Ts:function(){return w},U2:function(){return s},UO:function(){return Z},V2:function(){return g},Z$:function(){return p},fN:function(){return S},fg:function(){return O},h4:function(){return J},hH:function(){return _},np:function(){return F},p9:function(){return m},r8:function(){return N},tI:function(){return j},tt:function(){return D},wK:function(){return a},wo:function(){return c},xd:function(){return R},yo:function(){return A}});var n=r(4316);async function o(){if(!n.O)throw Error("Supabase n\xe3o configurado");let{data:e,error:t}=await n.O.from("customers").select("*").order("name");if(t)throw t;return e||[]}async function i(e){if(!n.O)throw Error("Supabase n\xe3o configurado");let{error:t}=await n.O.from("customers").delete().eq("id",e);if(t)throw t}async function a(e){if(!n.O)throw Error("Supabase n\xe3o configurado");let{data:t,error:r}=await n.O.from("customers").insert([e]).select("*").single();if(r)throw r;return t}async function s(){if(!n.O)throw Error("Supabase n\xe3o configurado");let{data:e,error:t}=await n.O.from("services").select("*").order("name");if(t)throw t;return e||[]}async function c(e){if(!n.O)throw Error("Supabase n\xe3o configurado");let{error:t}=await n.O.from("services").delete().eq("id",e);if(t)throw t}async function u(e){if(!n.O)throw Error("Supabase n\xe3o configurado");let{data:t,error:r}=await n.O.from("services").insert([e]).select("*").single();if(r)throw r;return t}async function l(e,t){if(!n.O)throw Error("Supabase n\xe3o configurado");let{data:r,error:o}=await n.O.from("services").update(t).eq("id",e).select("*").single();if(o)throw o;return r}async function f(){if(!n.O)throw Error("Supabase n\xe3o configurado");let{data:e,error:t}=await n.O.from("invoices").select("\n      id,\n      invoice_number,\n      issue_date,\n      due_date,\n      subtotal,\n      tax,\n      total,\n      status,\n      pdf_url,\n      appointments ( customers (name), services (name) )\n    ").order("issue_date",{ascending:!1});if(t)throw t;return e||[]}async function d(e){if(!n.O)throw Error("Supabase n\xe3o configurado");let{data:t,error:r}=await n.O.from("invoices").select("\n      id,\n      invoice_number,\n      issue_date,\n      due_date,\n      subtotal,\n      tax,\n      total,\n      status,\n      pdf_url,\n      appointments ( customers (name), services (name) )\n    ").eq("id",e).single();if(r)throw r;return t||null}async function m(e){if(!n.O)throw Error("Supabase n\xe3o configurado");if(!e||0===e.length)return[];let{data:t,error:r}=await n.O.from("invoices").select("appointment_id").in("appointment_id",e);if(r)throw r;return t||[]}async function p(e){if(!n.O)throw Error("Supabase n\xe3o configurado");let{data:t,error:r}=await n.O.from("invoices").insert([e]).select("*").single();if(r)throw r;return t}async function h(e,t){let r=await fetch("/api/invoices/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})});if(!r.ok){let e=await r.json().catch(()=>({}));throw Error((null==e?void 0:e.error)||"Falha ao atualizar fatura")}}async function w(){if(!n.O)throw Error("Supabase n\xe3o configurado");let{data:e,error:t}=await n.O.from("appointments").select("*, customers (name, phone), services (name, duration_minutes)");if(t)throw t;return e||[]}async function g(e){if(!n.O)throw Error("Supabase n\xe3o configurado");let{error:t}=await n.O.from("appointments").delete().eq("id",e);if(t)throw t}async function y(){if(!n.O)throw Error("Supabase n\xe3o configurado");let{data:e,error:t}=await n.O.from("appointments").select("*");if(t)throw t;return e||[]}async function b(e){if(!n.O)throw Error("Supabase n\xe3o configurado");let{data:t,error:r}=await n.O.from("appointments").insert([e]).select("*").single();if(r)throw r;return t}async function O(){if(!n.O)throw Error("Supabase n\xe3o configurado");let{data:e,error:t}=await n.O.from("appointments").select("*, customers (name, phone, email), services (name, duration_minutes)");if(t)throw t;return e||[]}async function v(e){let t,r;if(!n.O)throw Error("Supabase n\xe3o configurado");if(e&&/^\d{4}-\d{2}$/.test(e)){let[n,o]=e.split("-").map(Number),i=new Date(Date.UTC(n,o-1,1)),a=new Date(Date.UTC(n,o,1));t=i.toISOString().slice(0,10),r=a.toISOString().slice(0,10)}let o=n.O.from("cashflow_transactions").select("id, type, category, amount, transaction_date, client_id");t&&r&&(o=o.gte("transaction_date",t).lt("transaction_date",r));let{data:i,error:a}=await o;if(a)throw a;let s=(i||[]).filter(e=>"income"===e.type).reduce((e,t)=>e+Number(t.amount||0),0),c=(i||[]).filter(e=>"expense"===e.type).reduce((e,t)=>e+Number(t.amount||0),0),u={};(i||[]).filter(e=>"expense"===e.type).forEach(e=>{let t=e.category||"outros";u[t]=(u[t]||0)+Number(e.amount||0)});let l=[],f=Array.from(new Set((i||[]).filter(e=>"income"===e.type&&e.client_id).map(e=>e.client_id)));if(f.length>0){let{data:e}=await n.O.from("customers").select("id, name").in("id",f),t={};(i||[]).filter(e=>"income"===e.type&&e.client_id).forEach(e=>{let r=e.client_id;t[r]=(t[r]||0)+Number(e.amount||0)}),(l=(e||[]).map(e=>({client_id:e.id,name:e.name,total:t[e.id]||0}))).sort((e,t)=>t.total-e.total)}return{month:e||null,summary:{income:s,expense:c,net:s-c},expenseByCategory:u,incomeByClient:l}}async function x(e){if(!n.O)throw Error("Supabase n\xe3o configurado");let t={type:"expense",category:e.category||"other",amount:Number(e.amount||0),transaction_date:(e.date||new Date().toISOString()).slice(0,10),description:e.description||null};if(!t.amount||t.amount<=0)throw Error("Valor inv\xe1lido");let{data:r,error:o}=await n.O.from("cashflow_transactions").insert(t).select("*").single();if(o)throw o;return r}async function S(){if(!n.O)throw Error("Supabase n\xe3o configurado");let{data:e,error:t}=await n.O.from("employees").select("*");if(t)throw t;return e||[]}async function _(e){if(!n.O)throw Error("Supabase n\xe3o configurado");let{data:t,error:r}=await n.O.from("employee_work_records").select("*").eq("employeeId",e);if(r)throw r;return t||[]}async function j(){if(!n.O)throw Error("Supabase n\xe3o configurado");let{data:e}=await n.O.from("company").select("*").single();return e||null}async function E(e){if(!n.O)throw Error("Supabase n\xe3o configurado");let{data:t,error:r}=await n.O.from("employees").select("*").eq("id",e).single();if(r)throw r;return t||null}async function N(e){if(!n.O)throw Error("Supabase n\xe3o configurado");let t=(e.cpf||"").toString().replace(/\D/g,"");if(!t)throw Error("CPF inv\xe1lido");let{data:r}=await n.O.from("employees").select("id").eq("cpf",t).limit(1);if(r&&r.length>0)throw Error("CPF j\xe1 cadastrado");let{error:o}=await n.O.from("employees").insert([{...e,cpf:t}]);if(o)throw o}async function k(e,t){if(!n.O)throw Error("Supabase n\xe3o configurado");let r=(t.cpf||"").toString().replace(/\D/g,"");if(r){let{data:t}=await n.O.from("employees").select("id").eq("cpf",r).neq("id",e).limit(1);if(t&&t.length>0)throw Error("CPF j\xe1 cadastrado")}let{error:o}=await n.O.from("employees").update({...t,cpf:r||t.cpf}).eq("id",e);if(o)throw o}async function q(e){if(!n.O)throw Error("Supabase n\xe3o configurado");let{error:t}=await n.O.from("employees").delete().eq("id",e);if(t)throw t}async function C(e){if(!n.O)throw Error("Supabase n\xe3o configurado");let t={employeeId:e.employeeId,workDate:e.workDate,workDays:e.workDays,dailyRate:e.dailyRate,totalAmount:Number(e.dailyRate||0)*Number(e.workDays||0),notes:e.notes||null,paid:!1},{error:r}=await n.O.from("employee_work_records").insert([t]);if(r)throw r}async function z(e,t){let r=await fetch("/api/employees/work-records/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({paid:t})});if(!r.ok){let e=await r.json().catch(()=>({}));throw Error((null==e?void 0:e.error)||"Falha ao atualizar registro de trabalho")}}async function I(e){if(!n.O)throw Error("Supabase n\xe3o configurado");let t={name:e.name,cnpj:e.cnpj,phone:e.phone,email:e.email,address:e.address,bank_info:e.bank_info,logo_url:e.logo_url,updated_at:new Date().toISOString()};if(e.id){let{data:r,error:o}=await n.O.from("company").update(t).eq("id",e.id).select("*").single();if(o)throw o;return r}{let{data:e,error:r}=await n.O.from("company").insert(t).select("*").single();if(r)throw r;return e}}async function P(){if(!n.O)throw Error("Supabase n\xe3o configurado");let{data:e,error:t}=await n.O.from("quotes").select("*, customers (name, phone), services (name)");if(t){if("PGRST205"===t.code)return[];throw t}return(e||[]).sort((e,t)=>(t.created_at||"").localeCompare(e.created_at||""))}async function D(e){if(!n.O)throw Error("Supabase n\xe3o configurado");let{data:t,error:r}=await n.O.from("quotes").select("*, customers (*), services (*), quote_items (*), quote_images (*)").eq("id",e).single();if(r){if("PGRST205"===r.code)return null;throw r}return t||null}async function L(e){if(!n.O)throw Error("Supabase n\xe3o configurado");let{data:t,error:r}=await n.O.from("quotes").insert([e]).select("*").single();if(r)throw r;return t}async function R(e,t){if(!n.O)throw Error("Supabase n\xe3o configurado");let{data:r,error:o}=await n.O.from("quotes").update(t).eq("id",e).select("*").single();if(o)throw o;return r}async function Z(e){if(!n.O)throw Error("Supabase n\xe3o configurado");let{error:t}=await n.O.from("quotes").delete().eq("id",e);if(t)throw t}async function J(e){if(!n.O)throw Error("Supabase n\xe3o configurado");let{data:t,error:r}=await n.O.from("quote_items").insert([e]).select("*").single();if(r)throw r;return t}async function A(e,t){if(!n.O)throw Error("Supabase n\xe3o configurado");let{data:r,error:o}=await n.O.from("quote_items").update(t).eq("id",e).select("*").single();if(o)throw o;return r}async function F(e){if(!n.O)throw Error("Supabase n\xe3o configurado");let{error:t}=await n.O.from("quote_items").delete().eq("id",e);if(t)throw t}},4316:function(e,t,r){"use strict";r.d(t,{O:function(){return a}});var n=r(4170);let o="https://hyygforlvwbbdzpctnid.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh5eWdmb3JsdndiYmR6cGN0bmlkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMyNjY1NjksImV4cCI6MjA3ODg0MjU2OX0.1ih4fZRYRzg1oqZxAYonDPi5wO2-DHvb7anjcSPWeqs",a="string"==typeof o&&"string"==typeof i&&o.startsWith("https://")&&o.includes(".supabase.co")&&!o.includes("example.supabase.co")&&i.length>20?(0,n.createBrowserClient)(o,i):null}},function(e){e.O(0,[46,170,138,971,23,744],function(){return e(e.s=5711)}),_N_E=e.O()}]);