(()=>{var e={};e.id=566,e.ids=[566],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9244:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>o}),s(9606),s(564),s(7629),s(5866);var a=s(3191),r=s(8716),i=s(7922),n=s.n(i),l=s(5231),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);s.d(t,d);let o=["",{children:["orcamentos",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,9606)),"C:\\Users\\Enzo Marcelo\\Desktop\\testes SOLO TRAE\\crm casa limpa\\src\\app\\orcamentos\\[id]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,564)),"C:\\Users\\Enzo Marcelo\\Desktop\\testes SOLO TRAE\\crm casa limpa\\src\\app\\layout.tsx"],error:[()=>Promise.resolve().then(s.bind(s,7629)),"C:\\Users\\Enzo Marcelo\\Desktop\\testes SOLO TRAE\\crm casa limpa\\src\\app\\error.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\Enzo Marcelo\\Desktop\\testes SOLO TRAE\\crm casa limpa\\src\\app\\orcamentos\\[id]\\page.tsx"],u="/orcamentos/[id]/page",m={require:s,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/orcamentos/[id]/page",pathname:"/orcamentos/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},6818:(e,t,s)=>{Promise.resolve().then(s.bind(s,8222))},6557:(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});var a=s(7577),r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),n=(e,t)=>{let s=(0,a.forwardRef)(({color:s="currentColor",size:n=24,strokeWidth:l=2,absoluteStrokeWidth:d,className:o="",children:c,...u},m)=>(0,a.createElement)("svg",{ref:m,...r,width:n,height:n,stroke:s,strokeWidth:d?24*Number(l)/Number(n):l,className:["lucide",`lucide-${i(e)}`,o].join(" "),...u},[...t.map(([e,t])=>(0,a.createElement)(e,t)),...Array.isArray(c)?c:[c]]));return s.displayName=`${e}`,s}},3085:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(6557).Z)("Bold",[["path",{d:"M14 12a4 4 0 0 0 0-8H6v8",key:"v2sylx"}],["path",{d:"M15 20a4 4 0 0 0 0-8H6v8Z",key:"1ef5ya"}]])},1890:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(6557).Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},6283:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(6557).Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},3547:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(6557).Z)("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]])},3855:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(6557).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},1215:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(6557).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},5094:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(6557).Z)("Underline",[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]])},4019:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(6557).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},8222:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>b});var a=s(326),r=s(7577),i=s(5047),n=s(434),l=s(6499),d=s(2777),o=s(1890),c=s(6283),u=s(1215),m=s(3085),p=s(3547),x=s(5094),h=s(3855),y=s(4019),g=s(3863);function b(){let e=(0,i.useParams)();e?.id;let[t,s]=(0,r.useState)(!0),[b,v]=(0,r.useState)(!1),[j,N]=(0,r.useState)(null),[f,w]=(0,r.useState)([]),_=(0,r.useRef)(null),[k,C]=(0,r.useState)(""),[A,S]=(0,r.useState)(""),[M,q]=(0,r.useState)([]),[T,Z]=(0,r.useState)(!1),P=(0,r.useMemo)(()=>f.reduce((e,t)=>e+Number(t.unit_price||0)*Number(t.quantity||0),0),[f]),O=(0,r.useMemo)(()=>{let e=Math.max(0,Math.min(Number(j?.discount||0),P));return P-e+Math.max(0,Number(j?.taxes||0))},[P,j?.discount,j?.taxes]),E=(0,r.useMemo)(()=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}),[]),z=e=>{document.execCommand(e),C(_.current?.innerHTML||"")},L=async()=>{w([...f,{description:"",quantity:1,unit:"un",unit_price:0,total:0}])},R=async()=>{if(j){v(!0);try{let e={residence_type:j.residence_type,area_m2:Number(j.area_m2||0),service_modality:j.service_modality,valid_until:j.valid_until||null,discount:Number(j.discount||0),taxes:Number(j.taxes||0),subtotal:Number(P||0),total:Number(O||0),status:j.status,notes:j.notes||null,rich_content:{html:k},title:j.title||"Or\xe7amento",initial_report:j.initial_report||null,activities:Array.isArray(j.activities)?j.activities:null,payment_methods:M.length?M:null,contract_terms:j.contract_terms||null,client_label:j.client_label||null,client_subtitle:j.client_subtitle||null};for(let t of(await (0,l.xd)(j.id,e),f))t.id?await (0,l.yo)(t.id,{description:t.description,quantity:Number(t.quantity||0),unit:t.unit||"un",unit_price:Number(t.unit_price||0),total:Number(t.unit_price||0)*Number(t.quantity||0)}):await (0,l.h4)({quote_id:j.id,description:t.description,quantity:Number(t.quantity||0),unit:t.unit||"un",unit_price:Number(t.unit_price||0),total:Number(t.unit_price||0)*Number(t.quantity||0)});alert("Or\xe7amento atualizado!")}catch(e){console.error("Erro ao salvar or\xe7amento:",e),alert("Erro ao salvar or\xe7amento")}finally{v(!1)}}},U=async e=>{let t=f[e];if(w(f.filter((t,s)=>s!==e)),t?.id)try{await (0,l.np)(t.id)}catch(e){console.error(e)}};return t?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):j?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(n.default,{href:"/orcamentos",className:"text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[a.jsx(o.Z,{className:"w-4 h-4"})," Voltar"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(n.default,{href:`/api/orcamentos/${j.id}/pdf`,target:"_blank",className:"bg-gray-100 px-3 py-2 rounded hover:bg-gray-200 flex items-center gap-2",children:[a.jsx(c.Z,{className:"w-4 h-4"})," PDF"]}),(0,a.jsxs)("button",{onClick:R,disabled:b,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2 disabled:opacity-60",children:[a.jsx(u.Z,{className:"w-4 h-4"})," Salvar"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tipo de resid\xeancia"}),(0,a.jsxs)("select",{value:j.residence_type,onChange:e=>N({...j,residence_type:e.target.value}),className:"mt-1 w-full border rounded-lg px-3 py-2",children:[a.jsx("option",{value:"casa",children:"Casa"}),a.jsx("option",{value:"apartamento",children:"Apartamento"}),a.jsx("option",{value:"comercial",children:"Comercial"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"\xc1rea (m\xb2)"}),a.jsx("input",{type:"number",value:j.area_m2||0,onChange:e=>N({...j,area_m2:Number(e.target.value)}),className:"mt-1 w-full border rounded-lg px-3 py-2"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Modalidade"}),(0,a.jsxs)("select",{value:j.service_modality,onChange:e=>N({...j,service_modality:e.target.value}),className:"mt-1 w-full border rounded-lg px-3 py-2",children:[a.jsx("option",{value:"avulso",children:"Avulso"}),a.jsx("option",{value:"mensal",children:"Mensal"}),a.jsx("option",{value:"semanal",children:"Semanal"}),a.jsx("option",{value:"quinzenal",children:"Quinzenal"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Validade"}),a.jsx("input",{type:"date",value:j.valid_until||"",onChange:e=>N({...j,valid_until:e.target.value}),className:"mt-1 w-full border rounded-lg px-3 py-2"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Relat\xf3rio Inicial"}),a.jsx("textarea",{value:j?.initial_report||"",onChange:e=>N({...j,initial_report:e.target.value}),className:"mt-1 w-full border rounded-lg px-3 py-2",rows:5})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:()=>z("bold"),className:"px-2 py-1 border rounded",children:a.jsx(m.Z,{className:"w-4 h-4"})}),a.jsx("button",{type:"button",onClick:()=>z("italic"),className:"px-2 py-1 border rounded",children:a.jsx(p.Z,{className:"w-4 h-4"})}),a.jsx("button",{type:"button",onClick:()=>z("underline"),className:"px-2 py-1 border rounded",children:a.jsx(x.Z,{className:"w-4 h-4"})})]}),a.jsx("div",{ref:_,contentEditable:!0,onInput:()=>{C(_.current?.innerHTML||"")},className:"min-h-[160px] border rounded-lg p-3 focus:outline-none",dangerouslySetInnerHTML:{__html:k}}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Observa\xe7\xf5es"}),a.jsx("textarea",{value:j.notes||"",onChange:e=>N({...j,notes:e.target.value}),className:"mt-1 w-full border rounded-lg px-3 py-2",rows:3})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,a.jsxs)("div",{className:"p-4 border-b flex justify-between items-center",children:[a.jsx("span",{className:"font-medium",children:"Itens do or\xe7amento"}),(0,a.jsxs)("button",{onClick:L,className:"bg-gray-100 hover:bg-gray-200 px-3 py-2 rounded flex items-center gap-2",children:[a.jsx(h.Z,{className:"w-4 h-4"})," Adicionar item"]})]}),a.jsx("div",{className:"p-4 overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Descri\xe7\xe3o"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Qtd"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Unidade"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Valor unit\xe1rio"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Total"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"A\xe7\xf5es"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f.map((e,t)=>(0,a.jsxs)("tr",{children:[a.jsx("td",{className:"px-3 py-2",children:a.jsx("input",{value:e.description,onChange:e=>{let s=e.target.value,a=[...f];a[t].description=s,w(a)},className:"w-full border rounded px-2 py-1"})}),a.jsx("td",{className:"px-3 py-2",children:a.jsx("input",{type:"number",value:e.quantity,onChange:e=>{let s=Number(e.target.value),a=[...f];a[t].quantity=s,w(a)},className:"w-full border rounded px-2 py-1"})}),a.jsx("td",{className:"px-3 py-2",children:a.jsx("input",{value:e.unit||"un",onChange:e=>{let s=e.target.value,a=[...f];a[t].unit=s,w(a)},className:"w-full border rounded px-2 py-1"})}),a.jsx("td",{className:"px-3 py-2",children:a.jsx("input",{type:"number",value:e.unit_price,onChange:e=>{let s=Number(e.target.value),a=[...f];a[t].unit_price=s,w(a)},className:"w-full border rounded px-2 py-1"})}),(0,a.jsxs)("td",{className:"px-3 py-2 text-sm",children:["R$ ",(Number(e.unit_price||0)*Number(e.quantity||0)).toFixed(2)]}),a.jsx("td",{className:"px-3 py-2",children:(0,a.jsxs)("button",{onClick:()=>U(t),className:"text-red-600 hover:text-red-800 flex items-center gap-1",children:[a.jsx(y.Z,{className:"w-4 h-4"})," Remover"]})})]},e.id||t))})]})}),(0,a.jsxs)("div",{className:"p-4 border-t grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Desconto"}),a.jsx("input",{type:"number",value:j.discount||0,onChange:e=>N({...j,discount:Number(e.target.value)}),className:"mt-1 w-full border rounded-lg px-3 py-2"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Taxas"}),a.jsx("input",{type:"number",value:j.taxes||0,onChange:e=>N({...j,taxes:Number(e.target.value)}),className:"mt-1 w-full border rounded-lg px-3 py-2"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"text-sm",children:["Subtotal: ",a.jsx("strong",{children:E.format(P)})]}),(0,a.jsxs)("div",{className:"text-sm",children:["Desconto: ",a.jsx("strong",{children:E.format(Math.max(0,Math.min(Number(j?.discount||0),P)))})]}),(0,a.jsxs)("div",{className:"text-sm",children:["Taxas: ",a.jsx("strong",{children:E.format(Math.max(0,Number(j?.taxes||0)))})]}),(0,a.jsxs)("div",{className:"text-lg",children:["Total: ",a.jsx("strong",{children:E.format(O)})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[a.jsx("div",{className:"p-4 border-b flex justify-between items-center",children:a.jsx("span",{className:"font-medium",children:"Descri\xe7\xe3o das atividades"})}),(0,a.jsxs)("div",{className:"p-4 space-y-3",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx("input",{value:A,onChange:e=>S(e.target.value),className:"flex-1 border rounded px-2 py-2",placeholder:"Ex.: Limpeza total do apartamento"}),a.jsx("button",{onClick:()=>{if(!A.trim())return;let e=Array.isArray(j?.activities)?[...j.activities]:[];e.push(A.trim()),N({...j,activities:e}),S("")},className:"bg-gray-100 hover:bg-gray-200 px-3 py-2 rounded",children:"Adicionar"})]}),a.jsx("ul",{className:"list-disc pl-6 space-y-1",children:(Array.isArray(j?.activities)?j.activities:[]).map((e,t)=>(0,a.jsxs)("li",{className:"flex justify-between items-center",children:[a.jsx("span",{children:e}),a.jsx("button",{onClick:()=>N({...j,activities:j.activities.filter((e,s)=>s!==t)}),className:"text-red-600 text-sm",children:"Remover"})]},t))})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[a.jsx("div",{className:"p-4 border-b",children:a.jsx("span",{className:"font-medium",children:"Imagens"})}),(0,a.jsxs)("div",{className:"p-4 space-y-3",children:[a.jsx("input",{type:"file",multiple:!0,onChange:async e=>{let t=e.target.files;if(t&&d.O&&j?.id){Z(!0);try{let e=d.O.storage.from("quotes");for(let s of Array.from(t)){let t=`${j.id}/${Date.now()}-${s.name}`,{error:a}=await e.upload(t,s,{upsert:!0});if(a)continue;let{data:r}=e.getPublicUrl(t);await fetch("/api/quotes/images",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({quote_id:j.id,url:r.publicUrl})})}alert("Imagens enviadas")}finally{Z(!1)}}}}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:j?.quote_images?.map(e=>a.jsx("div",{className:"relative",children:a.jsx("img",{src:e.url,alt:e.caption||"",className:"w-full h-24 object-cover rounded"})},e.id))})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[a.jsx("div",{className:"p-4 border-b",children:a.jsx("span",{className:"font-medium",children:"M\xe9todos de pagamento"})}),a.jsx("div",{className:"p-4 grid grid-cols-2 md:grid-cols-4 gap-2",children:["pix","transferencia","cartao","dinheiro"].map(e=>(0,a.jsxs)("label",{className:"inline-flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:M.includes(e),onChange:t=>q(s=>t.target.checked?[...s,e]:s.filter(t=>t!==e))}),a.jsx("span",{className:"capitalize",children:e})]},e))})]}),a.jsx(g.Z,{context:{titulo:j?.title,cliente:j?.customers||void 0,servico:j?.services||void 0,residencia:j?.residence_type,area_m2:j?.area_m2,modalidade:j?.service_modality,valid_until:j?.valid_until||null,itens:f.map(e=>({description:e.description,quantity:e.quantity,unit:e.unit||"un",unit_price:e.unit_price})),subtotal:P,total:O},onSetValidUntil:e=>N(t=>({...t,valid_until:e})),onAddItem:e=>w(t=>[...t,{id:"",description:e.description,quantity:e.quantity,unit:e.unit||"un",unit_price:e.unit_price,total:Number(e.unit_price||0)*Number(e.quantity||0)}]),onSetTemplateAppend:e=>C(t=>(t||"")+e),onSetActivities:e=>N(t=>({...t,activities:e})),onSetContractTerms:e=>N(t=>({...t,contract_terms:e})),onSetPaymentMethods:e=>q(e)})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)(n.default,{href:"/orcamentos",className:"text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[a.jsx(o.Z,{className:"w-4 h-4"})," Voltar"]}),a.jsx("div",{className:"text-gray-600",children:"Or\xe7amento n\xe3o encontrado."})]})}},3863:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var a=s(326),r=s(7577);function i(e){let[t,s]=(0,r.useState)(!1),[i,n]=(0,r.useState)(""),[l,d]=(0,r.useState)(!1),[o,c]=(0,r.useState)([]),u=async()=>{if(!i.trim())return;let t=[...o,{role:"user",content:i}];c(t),d(!0);try{let s=await fetch("/api/chatbot/budget",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:[{role:"user",content:i}],context:e.context})}),a=await s.json(),r=String(a?.reply||"Sem resposta no momento.");c([...t,{role:"assistant",content:r,actions:a?.actions}])}catch{c([...t,{role:"assistant",content:"Falha ao responder. Tente novamente."}])}finally{d(!1),n("")}},m=t=>{if(t){if(t.setValidUntil&&e.onSetValidUntil&&e.onSetValidUntil(t.setValidUntil),Array.isArray(t.addItems)&&e.onAddItem)for(let s of t.addItems)e.onAddItem(s);t.setTemplateAppend&&e.onSetTemplateAppend&&e.onSetTemplateAppend(t.setTemplateAppend),Array.isArray(t.setActivities)&&e.onSetActivities&&e.onSetActivities(t.setActivities),"string"==typeof t.setContractTerms&&e.onSetContractTerms&&e.onSetContractTerms(t.setContractTerms),Array.isArray(t.setPaymentMethods)&&e.onSetPaymentMethods&&e.onSetPaymentMethods(t.setPaymentMethods)}};return a.jsx("div",{className:"fixed bottom-4 right-4 z-50",children:t?(0,a.jsxs)("div",{className:"w-[320px] bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-200 dark:border-gray-700",children:[a.jsx("span",{className:"font-medium",children:"Assistente de Or\xe7amento"}),a.jsx("button",{onClick:()=>s(!1),className:"text-gray-500",children:"✕"})]}),(0,a.jsxs)("div",{className:"h-64 overflow-y-auto px-3 py-2 space-y-2",children:[o.map((e,t)=>(0,a.jsxs)("div",{className:"user"===e.role?"text-right":"text-left",children:[a.jsx("div",{className:`inline-block px-3 py-2 rounded ${"user"===e.role?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 dark:text-gray-100"}`,children:e.content}),"assistant"===e.role&&e.actions&&a.jsx("div",{className:"mt-2",children:a.jsx("button",{onClick:()=>m(e.actions),className:"text-sm bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-100 px-2 py-1 rounded",children:"Aplicar sugest\xe3o"})})]},t)),0===o.length&&a.jsx("div",{className:"text-sm text-gray-500",children:"Fa\xe7a perguntas como “sugira itens”, “defina validade”, “preencha texto do template”."})]}),a.jsx("div",{className:"px-3 py-2 border-t border-gray-200 dark:border-gray-700",children:(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx("input",{value:i,onChange:e=>n(e.target.value),placeholder:"Digite sua pergunta",className:"flex-1 border rounded px-2 py-2"}),a.jsx("button",{onClick:u,disabled:l,className:"bg-blue-600 text-white px-3 py-2 rounded",children:l?"...":"Enviar"})]})})]}):a.jsx("button",{onClick:()=>s(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg shadow",children:"Ajuda"})})}},9606:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>i,default:()=>l});var a=s(8570);let r=(0,a.createProxy)(String.raw`C:\Users\Enzo Marcelo\Desktop\testes SOLO TRAE\crm casa limpa\src\app\orcamentos\[id]\page.tsx`),{__esModule:i,$$typeof:n}=r;r.default;let l=(0,a.createProxy)(String.raw`C:\Users\Enzo Marcelo\Desktop\testes SOLO TRAE\crm casa limpa\src\app\orcamentos\[id]\page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[8948,275,62],()=>s(9244));module.exports=a})();