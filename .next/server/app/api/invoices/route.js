"use strict";(()=>{var e={};e.id=1243,e.ids=[1243],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},285:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>g,patchFetch:()=>j,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>v,staticGenerationAsyncStorage:()=>m});var n={};s.r(n),s.d(n,{GET:()=>p,POST:()=>u});var o=s(9303),i=s(8716),r=s(670),a=s(7070),c=s(748);async function p(e){let{supabase:t,user:s}=await (0,c.n)(e);if(!s)return a.NextResponse.json({error:"N\xe3o autenticado"},{status:401});let{data:n,error:o}=await t.from("invoices").select("*, appointments(id, appointment_date, customers(name), services(name))").order("issue_date",{ascending:!1});return o?a.NextResponse.json({error:o.message},{status:400}):a.NextResponse.json(n??[])}async function u(e){let{supabase:t,user:s}=await (0,c.n)(e);if(!s)return a.NextResponse.json({error:"N\xe3o autenticado"},{status:401});let{appointmentId:n,subtotal:o,tax:i}=await e.json(),r=`INV-${Date.now()}`,p="number"==typeof o?o:0,u="number"==typeof i?i:0,{data:d,error:l}=await t.from("invoices").insert([{appointment_id:n,invoice_number:r,subtotal:p,tax:u,total:p+u}]).select("*").single();return l?a.NextResponse.json({error:l.message},{status:400}):a.NextResponse.json(d,{status:201})}let d=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/invoices/route",pathname:"/api/invoices",filename:"route",bundlePath:"app/api/invoices/route"},resolvedPagePath:"C:\\Users\\Enzo Marcelo\\Desktop\\testes SOLO TRAE\\crm casa limpa\\src\\app\\api\\invoices\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:l,staticGenerationAsyncStorage:m,serverHooks:v}=d,g="/api/invoices/route";function j(){return(0,r.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:m})}},748:(e,t,s)=>{s.d(t,{n:()=>o});var n=s(2305);async function o(e){let t=(0,n.createServerClient)("https://hyygforlvwbbdzpctnid.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh5eWdmb3JsdndiYmR6cGN0bmlkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMyNjY1NjksImV4cCI6MjA3ODg0MjU2OX0.1ih4fZRYRzg1oqZxAYonDPi5wO2-DHvb7anjcSPWeqs",{cookies:{getAll:()=>e.cookies.getAll(),setAll(t){t.forEach(({name:t,value:s})=>e.cookies.set(t,s))}}}),{data:{user:s}}=await t.auth.getUser();return{supabase:t,user:s}}}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),n=t.X(0,[8948,5972,2305],()=>s(285));module.exports=n})();