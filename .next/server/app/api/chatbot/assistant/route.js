"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/chatbot/assistant/route";
exports.ids = ["app/api/chatbot/assistant/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchatbot%2Fassistant%2Froute&page=%2Fapi%2Fchatbot%2Fassistant%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchatbot%2Fassistant%2Froute.ts&appDir=C%3A%5CUsers%5CEnzo%20Marcelo%5CDesktop%5Ctestes%20SOLO%20TRAE%5Ccrm%20casa%20limpa%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CEnzo%20Marcelo%5CDesktop%5Ctestes%20SOLO%20TRAE%5Ccrm%20casa%20limpa&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchatbot%2Fassistant%2Froute&page=%2Fapi%2Fchatbot%2Fassistant%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchatbot%2Fassistant%2Froute.ts&appDir=C%3A%5CUsers%5CEnzo%20Marcelo%5CDesktop%5Ctestes%20SOLO%20TRAE%5Ccrm%20casa%20limpa%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CEnzo%20Marcelo%5CDesktop%5Ctestes%20SOLO%20TRAE%5Ccrm%20casa%20limpa&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_Enzo_Marcelo_Desktop_testes_SOLO_TRAE_crm_casa_limpa_src_app_api_chatbot_assistant_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/chatbot/assistant/route.ts */ \"(rsc)/./src/app/api/chatbot/assistant/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/chatbot/assistant/route\",\n        pathname: \"/api/chatbot/assistant\",\n        filename: \"route\",\n        bundlePath: \"app/api/chatbot/assistant/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\Enzo Marcelo\\\\Desktop\\\\testes SOLO TRAE\\\\crm casa limpa\\\\src\\\\app\\\\api\\\\chatbot\\\\assistant\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_Enzo_Marcelo_Desktop_testes_SOLO_TRAE_crm_casa_limpa_src_app_api_chatbot_assistant_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/chatbot/assistant/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjaGF0Ym90JTJGYXNzaXN0YW50JTJGcm91dGUmcGFnZT0lMkZhcGklMkZjaGF0Ym90JTJGYXNzaXN0YW50JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGY2hhdGJvdCUyRmFzc2lzdGFudCUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNFbnpvJTIwTWFyY2VsbyU1Q0Rlc2t0b3AlNUN0ZXN0ZXMlMjBTT0xPJTIwVFJBRSU1Q2NybSUyMGNhc2ElMjBsaW1wYSU1Q3NyYyU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q1VzZXJzJTVDRW56byUyME1hcmNlbG8lNUNEZXNrdG9wJTVDdGVzdGVzJTIwU09MTyUyMFRSQUUlNUNjcm0lMjBjYXNhJTIwbGltcGEmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQytEO0FBQzVJO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY3JtLWNhc2EtbGltcGEvPzFiZTIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiQzpcXFxcVXNlcnNcXFxcRW56byBNYXJjZWxvXFxcXERlc2t0b3BcXFxcdGVzdGVzIFNPTE8gVFJBRVxcXFxjcm0gY2FzYSBsaW1wYVxcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxjaGF0Ym90XFxcXGFzc2lzdGFudFxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvY2hhdGJvdC9hc3Npc3RhbnQvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9jaGF0Ym90L2Fzc2lzdGFudFwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvY2hhdGJvdC9hc3Npc3RhbnQvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJDOlxcXFxVc2Vyc1xcXFxFbnpvIE1hcmNlbG9cXFxcRGVza3RvcFxcXFx0ZXN0ZXMgU09MTyBUUkFFXFxcXGNybSBjYXNhIGxpbXBhXFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXGNoYXRib3RcXFxcYXNzaXN0YW50XFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9jaGF0Ym90L2Fzc2lzdGFudC9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchatbot%2Fassistant%2Froute&page=%2Fapi%2Fchatbot%2Fassistant%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchatbot%2Fassistant%2Froute.ts&appDir=C%3A%5CUsers%5CEnzo%20Marcelo%5CDesktop%5Ctestes%20SOLO%20TRAE%5Ccrm%20casa%20limpa%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CEnzo%20Marcelo%5CDesktop%5Ctestes%20SOLO%20TRAE%5Ccrm%20casa%20limpa&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/chatbot/assistant/route.ts":
/*!************************************************!*\
  !*** ./src/app/api/chatbot/assistant/route.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var _lib_ai_provider__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/ai/provider */ \"(rsc)/./src/lib/ai/provider.ts\");\n/* harmony import */ var _lib_supabaseServer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/supabaseServer */ \"(rsc)/./src/lib/supabaseServer.ts\");\n/* harmony import */ var _server_chat_tools__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/server/chat/tools */ \"(rsc)/./src/server/chat/tools.ts\");\n/* harmony import */ var _lib_logger__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/logger */ \"(rsc)/./src/lib/logger.ts\");\n/* harmony import */ var _lib_ratelimit__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/ratelimit */ \"(rsc)/./src/lib/ratelimit.ts\");\n\n\n\n\n\nfunction buildPrompt(messages, context, authUser) {\n    const userMsg = messages?.find((m)=>m.role === \"user\")?.content || \"\";\n    const parts = [];\n    const page = String(context?.page || \"dashboard\");\n    parts.push(`Página: ${page}`);\n    if (authUser) parts.push(`Usuário: ${authUser?.email || authUser?.id || \"\"}`);\n    const system = \"Voc\\xea \\xe9 o assistente do CRM Casa Limpa. Responda de forma objetiva e pr\\xe1tica. Ajude com finan\\xe7as, agenda, clientes e faturas. Quando conveniente, sugira passos acion\\xe1veis. N\\xe3o invente dados internos; ofere\\xe7a a\\xe7\\xf5es para consultar ou criar informa\\xe7\\xf5es.\";\n    return `${system}\\nContexto:\\n${parts.join(\"\\n\")}\\nPergunta:\\n${userMsg}`;\n}\nfunction heuristicReply(context, question) {\n    const reply = \"Posso consultar pend\\xeancias, gerar resumo financeiro, criar clientes, agendar servi\\xe7os e enviar lembretes de pagamento. Diga o que deseja e confirmarei antes de executar.\";\n    return {\n        reply\n    };\n}\nfunction streamText(text) {\n    const encoder = new TextEncoder();\n    const chunks = text.match(/.{1,80}/g) || [\n        text\n    ];\n    return new ReadableStream({\n        start (controller) {\n            let i = 0;\n            let delay = 15;\n            const push = ()=>{\n                if (i >= chunks.length) {\n                    controller.close();\n                    return;\n                }\n                controller.enqueue(encoder.encode(chunks[i]));\n                i += 1;\n                if (delay < 60) delay += 1;\n                setTimeout(push, delay);\n            };\n            push();\n        }\n    });\n}\nasync function POST(req) {\n    const start = Date.now();\n    const ctx = {\n        requestId: req.headers.get(\"x-request-id\") || undefined,\n        path: req.nextUrl.pathname,\n        method: req.method\n    };\n    try {\n        _lib_logger__WEBPACK_IMPORTED_MODULE_3__.logger.info(\"api_request_start\", ctx);\n        const ip = req.headers.get(\"x-forwarded-for\")?.split(\",\")[0] || null;\n        if (!(0,_lib_ratelimit__WEBPACK_IMPORTED_MODULE_4__.allow)(ip, \"chatbot\", 60, 60000)) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_3__.logger.warn(\"rate_limited\", {\n                ...ctx\n            });\n            return Response.json({\n                reply: \"Muitas solicita\\xe7\\xf5es. Tente novamente mais tarde.\"\n            }, {\n                status: 429\n            });\n        }\n        const body = await req.json();\n        const messages = body?.messages || [];\n        const context = body?.context || {};\n        const { user } = await (0,_lib_supabaseServer__WEBPACK_IMPORTED_MODULE_1__.getAuthUser)(req);\n        const question = messages?.find((m)=>m.role === \"user\")?.content || \"\";\n        const qlow = String(question).toLowerCase();\n        if (qlow.includes(\"resumo financeiro\") || qlow.includes(\"kpi\")) {\n            const kpis = await (0,_server_chat_tools__WEBPACK_IMPORTED_MODULE_2__.fetchKpis)(req);\n            const reply = `Clientes: ${kpis.totalCustomers}. Agendamentos: ${kpis.totalAppointments}. Receita mensal: R$ ${kpis.monthlyRevenue.toLocaleString(\"pt-BR\")}. Pendentes: ${kpis.pendingAppointments}.`;\n            const res = Response.json({\n                reply\n            });\n            _lib_logger__WEBPACK_IMPORTED_MODULE_3__.logger.info(\"api_request_end\", {\n                ...ctx,\n                status: 200,\n                duration_ms: Date.now() - start\n            });\n            return res;\n        }\n        if (qlow.includes(\"pend\\xeancias\") || qlow.includes(\"agenda\")) {\n            const items = await (0,_server_chat_tools__WEBPACK_IMPORTED_MODULE_2__.listAgendaToday)(req);\n            const text = items.map((i)=>`${i.time || \"\"} ${i.customer} - ${i.service} (${i.status})`).join(\"\\n\") || \"Sem compromissos para hoje.\";\n            const res = Response.json({\n                reply: text\n            });\n            _lib_logger__WEBPACK_IMPORTED_MODULE_3__.logger.info(\"api_request_end\", {\n                ...ctx,\n                status: 200,\n                duration_ms: Date.now() - start\n            });\n            return res;\n        }\n        if (qlow.includes(\"faturas em atraso\") || qlow.includes(\"lembrete de pagamento\")) {\n            const items = await (0,_server_chat_tools__WEBPACK_IMPORTED_MODULE_2__.listOverdueInvoices)(req);\n            const text = items.map((i)=>`#${i.invoice_number} ${i.client_name} venceu em ${new Date(i.due_date).toLocaleDateString(\"pt-BR\")} (R$ ${Number(i.total || 0).toLocaleString(\"pt-BR\")})`).join(\"\\n\") || \"Nenhuma fatura em atraso.\";\n            const res = Response.json({\n                reply: text\n            });\n            _lib_logger__WEBPACK_IMPORTED_MODULE_3__.logger.info(\"api_request_end\", {\n                ...ctx,\n                status: 200,\n                duration_ms: Date.now() - start\n            });\n            return res;\n        }\n        const prompt = buildPrompt(messages, context, user);\n        const hf = await (0,_lib_ai_provider__WEBPACK_IMPORTED_MODULE_0__.callHF)(prompt);\n        if (hf) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_3__.logger.info(\"chatbot_stream_start\", ctx);\n            return new Response(streamText(hf), {\n                headers: {\n                    \"Content-Type\": \"text/plain\"\n                }\n            });\n        }\n        const h = heuristicReply(context, messages?.find((m)=>m.role === \"user\")?.content || \"\");\n        const res = Response.json(h);\n        _lib_logger__WEBPACK_IMPORTED_MODULE_3__.logger.info(\"api_request_end\", {\n            ...ctx,\n            status: 200,\n            duration_ms: Date.now() - start\n        });\n        return res;\n    } catch (err) {\n        _lib_logger__WEBPACK_IMPORTED_MODULE_3__.logger.error(\"chatbot_error\", {\n            ...ctx,\n            err: err?.message || String(err)\n        });\n        return Response.json({\n            reply: \"N\\xe3o foi poss\\xedvel responder agora. Tente novamente.\",\n            error: true\n        }, {\n            status: 200\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9jaGF0Ym90L2Fzc2lzdGFudC9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFDMEM7QUFDUTtBQUM4RDtBQUMzRTtBQUNFO0FBRXZDLFNBQVNPLFlBQVlDLFFBQWtELEVBQUVDLE9BQVksRUFBRUMsUUFBYTtJQUNsRyxNQUFNQyxVQUFVSCxVQUFVSSxLQUFLLENBQUNDLElBQU1BLEVBQUVDLElBQUksS0FBSyxTQUFTQyxXQUFXO0lBQ3JFLE1BQU1DLFFBQVEsRUFBRTtJQUNoQixNQUFNQyxPQUFPQyxPQUFPVCxTQUFTUSxRQUFRO0lBQ3JDRCxNQUFNRyxJQUFJLENBQUMsQ0FBQyxRQUFRLEVBQUVGLEtBQUssQ0FBQztJQUM1QixJQUFJUCxVQUFVTSxNQUFNRyxJQUFJLENBQUMsQ0FBQyxTQUFTLEVBQUVULFVBQVVVLFNBQVNWLFVBQVVXLE1BQU0sR0FBRyxDQUFDO0lBQzVFLE1BQU1DLFNBQVM7SUFDZixPQUFPLENBQUMsRUFBRUEsT0FBTyxhQUFhLEVBQUVOLE1BQU1PLElBQUksQ0FBQyxNQUFNLGFBQWEsRUFBRVosUUFBUSxDQUFDO0FBQzNFO0FBRUEsU0FBU2EsZUFBZWYsT0FBWSxFQUFFZ0IsUUFBZ0I7SUFDcEQsTUFBTUMsUUFBUTtJQUNkLE9BQU87UUFBRUE7SUFBTTtBQUNqQjtBQUVBLFNBQVNDLFdBQVdDLElBQVk7SUFDOUIsTUFBTUMsVUFBVSxJQUFJQztJQUNwQixNQUFNQyxTQUFTSCxLQUFLSSxLQUFLLENBQUMsZUFBZTtRQUFDSjtLQUFLO0lBQy9DLE9BQU8sSUFBSUssZUFBZTtRQUN4QkMsT0FBTUMsVUFBVTtZQUNkLElBQUlDLElBQUk7WUFDUixJQUFJQyxRQUFRO1lBQ1osTUFBTWxCLE9BQU87Z0JBQ1gsSUFBSWlCLEtBQUtMLE9BQU9PLE1BQU0sRUFBRTtvQkFBRUgsV0FBV0ksS0FBSztvQkFBSTtnQkFBTztnQkFDckRKLFdBQVdLLE9BQU8sQ0FBQ1gsUUFBUVksTUFBTSxDQUFDVixNQUFNLENB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OUIsS0FBS0MsR0FBRyxLQUFLWjtRQUFNO1FBQ3RGLE9BQU93QztJQUNULEVBQUUsT0FBT2dCLEtBQVU7UUFDakJyRiwrQ0FBTUEsQ0FBQ3NGLEtBQUssQ0FBQyxpQkFBaUI7WUFBRSxHQUFHNUMsR0FBRztZQUFFMkMsS0FBS0EsS0FBS0UsV0FBVzFFLE9BQU93RTtRQUFLO1FBQ3pFLE9BQU85QixTQUFTQyxJQUFJLENBQUM7WUFBRW5DLE9BQU87WUFBc0RpRSxPQUFPO1FBQUssR0FBRztZQUFFN0IsUUFBUTtRQUFJO0lBQ25IO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jcm0tY2FzYS1saW1wYS8uL3NyYy9hcHAvYXBpL2NoYXRib3QvYXNzaXN0YW50L3JvdXRlLnRzP2E0OTAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QgfSBmcm9tICduZXh0L3NlcnZlcidcbmltcG9ydCB7IGNhbGxIRiB9IGZyb20gJ0AvbGliL2FpL3Byb3ZpZGVyJ1xuaW1wb3J0IHsgZ2V0QXV0aFVzZXIgfSBmcm9tICdAL2xpYi9zdXBhYmFzZVNlcnZlcidcbmltcG9ydCB7IGZldGNoS3BpcywgbGlzdEFnZW5kYVRvZGF5LCBjcmVhdGVDbGllbnQsIHNjaGVkdWxlSm9iLCBsaXN0T3ZlcmR1ZUludm9pY2VzIH0gZnJvbSAnQC9zZXJ2ZXIvY2hhdC90b29scydcbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gJ0AvbGliL2xvZ2dlcidcbmltcG9ydCB7IGFsbG93IH0gZnJvbSAnQC9saWIvcmF0ZWxpbWl0J1xuXG5mdW5jdGlvbiBidWlsZFByb21wdChtZXNzYWdlczogQXJyYXk8eyByb2xlOiBzdHJpbmc7IGNvbnRlbnQ6IHN0cmluZyB9PiwgY29udGV4dDogYW55LCBhdXRoVXNlcjogYW55KSB7XG4gIGNvbnN0IHVzZXJNc2cgPSBtZXNzYWdlcz8uZmluZCgobSkgPT4gbS5yb2xlID09PSAndXNlcicpPy5jb250ZW50IHx8ICcnXG4gIGNvbnN0IHBhcnRzID0gW10gYXMgc3RyaW5nW11cbiAgY29uc3QgcGFnZSA9IFN0cmluZyhjb250ZXh0Py5wYWdlIHx8ICdkYXNoYm9hcmQnKVxuICBwYXJ0cy5wdXNoKGBQw6FnaW5hOiAke3BhZ2V9YClcbiAgaWYgKGF1dGhVc2VyKSBwYXJ0cy5wdXNoKGBVc3XDoXJpbzogJHthdXRoVXNlcj8uZW1haWwgfHwgYXV0aFVzZXI/LmlkIHx8ICcnfWApXG4gIGNvbnN0IHN5c3RlbSA9ICdWb2PDqiDDqSBvIGFzc2lzdGVudGUgZG8gQ1JNIENhc2EgTGltcGEuIFJlc3BvbmRhIGRlIGZvcm1hIG9iamV0aXZhIGUgcHLDoXRpY2EuIEFqdWRlIGNvbSBmaW5hbsOnYXMsIGFnZW5kYSwgY2xpZW50ZXMgZSBmYXR1cmFzLiBRdWFuZG8gY29udmVuaWVudGUsIHN1Z2lyYSBwYXNzb3MgYWNpb27DoXZlaXMuIE7Do28gaW52ZW50ZSBkYWRvcyBpbnRlcm5vczsgb2ZlcmXDp2EgYcOnw7VlcyBwYXJhIGNvbnN1bHRhciBvdSBjcmlhciBpbmZvcm1hw6fDtWVzLidcbiAgcmV0dXJuIGAke3N5c3RlbX1cXG5Db250ZXh0bzpcXG4ke3BhcnRzLmpvaW4oJ1xcbicpfVxcblBlcmd1bnRhOlxcbiR7dXNlck1zZ31gXG59XG5cbmZ1bmN0aW9uIGhldXJpc3RpY1JlcGx5KGNvbnRleHQ6IGFueSwgcXVlc3Rpb246IHN0cmluZykge1xuICBjb25zdCByZXBseSA9ICdQb3NzbyBjb25zdWx0YXIgcGVuZMOqbmNpYXMsIGdlcmFyIHJlc3VtbyBmaW5hbmNlaXJvLCBjcmlhciBjbGllbnRlcywgYWdlbmRhciBzZXJ2acOnb3MgZSBlbnZpYXIgbGVtYnJldGVzIGRlIHBhZ2FtZW50by4gRGlnYSBvIHF1ZSBkZXNlamEgZSBjb25maXJtYXJlaSBhbnRlcyBkZSBleGVjdXRhci4nXG4gIHJldHVybiB7IHJlcGx5IH1cbn1cblxuZnVuY3Rpb24gc3RyZWFtVGV4dCh0ZXh0OiBzdHJpbmcpIHtcbiAgY29uc3QgZW5jb2RlciA9IG5ldyBUZXh0RW5jb2RlcigpXG4gIGNvbnN0IGNodW5rcyA9IHRleHQubWF0Y2goLy57MSw4MH0vZykgfHwgW3RleHRdXG4gIHJldHVybiBuZXcgUmVhZGFibGVTdHJlYW0oe1xuICAgIHN0YXJ0KGNvbnRyb2xsZXIpIHtcbiAgICAgIGxldCBpID0gMFxuICAgICAgbGV0IGRlbGF5ID0gMTVcbiAgICAgIGNvbnN0IHB1c2ggPSAoKSA9PiB7XG4gICAgICAgIGlmIChpID49IGNodW5rcy5sZW5ndGgpIHsgY29udHJvbGxlci5jbG9zZSgpOyByZXR1cm4gfVxuICAgICAgICBjb250cm9sbGVyLmVucXVldWUoZW5jb2Rlci5lbmNvZGUoY2h1bmtzW2ldKSlcbiAgICAgICAgaSArPSAxXG4gICAgICAgIGlmIChkZWxheSA8IDYwKSBkZWxheSArPSAxXG4gICAgICAgIHNldFRpbWVvdXQocHVzaCwgZGVsYXkpXG4gICAgICB9XG4gICAgICBwdXNoKClcbiAgICB9LFxuICB9KVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXE6IE5leHRSZXF1ZXN0KSB7XG4gIGNvbnN0IHN0YXJ0ID0gRGF0ZS5ub3coKVxuICBjb25zdCBjdHggPSB7IHJlcXVlc3RJZDogcmVxLmhlYWRlcnMuZ2V0KCd4LXJlcXVlc3QtaWQnKSB8fCB1bmRlZmluZWQsIHBhdGg6IHJlcS5uZXh0VXJsLnBhdGhuYW1lLCBtZXRob2Q6IHJlcS5tZXRob2QgfVxuICB0cnkge1xuICAgIGxvZ2dlci5pbmZvKCdhcGlfcmVxdWVzdF9zdGFydCcsIGN0eClcbiAgICBjb25zdCBpcCA9IHJlcS5oZWFkZXJzLmdldCgneC1mb3J3YXJkZWQtZm9yJyk/LnNwbGl0KCcsJylbMF0gfHwgbnVsbFxuICAgIGlmICghYWxsb3coaXAsICdjaGF0Ym90JywgNjAsIDYwXzAwMCkpIHtcbiAgICAgIGxvZ2dlci53YXJuKCdyYXRlX2xpbWl0ZWQnLCB7IC4uLmN0eCB9KVxuICAgICAgcmV0dXJuIFJlc3BvbnNlLmpzb24oeyByZXBseTogJ011aXRhcyBzb2xpY2l0YcOnw7Vlcy4gVGVudGUgbm92YW1lbnRlIG1haXMgdGFyZGUuJyB9LCB7IHN0YXR1czogNDI5IH0pXG4gICAgfVxuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXEuanNvbigpXG4gICAgY29uc3QgbWVzc2FnZXMgPSBib2R5Py5tZXNzYWdlcyB8fCBbXVxuICAgIGNvbnN0IGNvbnRleHQgPSBib2R5Py5jb250ZXh0IHx8IHt9XG4gICAgY29uc3QgeyB1c2VyIH0gPSBhd2FpdCBnZXRBdXRoVXNlcihyZXEpXG4gICAgY29uc3QgcXVlc3Rpb24gPSBtZXNzYWdlcz8uZmluZCgobTogYW55KSA9PiBtLnJvbGUgPT09ICd1c2VyJyk/LmNvbnRlbnQgfHwgJydcbiAgICBjb25zdCBxbG93ID0gU3RyaW5nKHF1ZXN0aW9uKS50b0xvd2VyQ2FzZSgpXG4gICAgaWYgKHFsb3cuaW5jbHVkZXMoJ3Jlc3VtbyBmaW5hbmNlaXJvJykgfHwgcWxvdy5pbmNsdWRlcygna3BpJykpIHtcbiAgICAgIGNvbnN0IGtwaXMgPSBhd2FpdCBmZXRjaEtwaXMocmVxKVxuICAgICAgY29uc3QgcmVwbHkgPSBgQ2xpZW50ZXM6ICR7a3Bpcy50b3RhbEN1c3RvbWVyc30uIEFnZW5kYW1lbnRvczogJHtrcGlzLnRvdGFsQXBwb2ludG1lbnRzfS4gUmVjZWl0YSBtZW5zYWw6IFIkICR7a3Bpcy5tb250aGx5UmV2ZW51ZS50b0xvY2FsZVN0cmluZygncHQtQlInKX0uIFBlbmRlbnRlczogJHtrcGlzLnBlbmRpbmdBcHBvaW50bWVudHN9LmBcbiAgICAgIGNvbnN0IHJlcyA9IFJlc3BvbnNlLmpzb24oeyByZXBseSB9KVxuICAgICAgbG9nZ2VyLmluZm8oJ2FwaV9yZXF1ZXN0X2VuZCcsIHsgLi4uY3R4LCBzdGF0dXM6IDIwMCwgZHVyYXRpb25fbXM6IERhdGUubm93KCkgLSBzdGFydCB9KVxuICAgICAgcmV0dXJuIHJlc1xuICAgIH1cbiAgICBpZiAocWxvdy5pbmNsdWRlcygncGVuZMOqbmNpYXMnKSB8fCBxbG93LmluY2x1ZGVzKCdhZ2VuZGEnKSkge1xuICAgICAgY29uc3QgaXRlbXMgPSBhd2FpdCBsaXN0QWdlbmRhVG9kYXkocmVxKVxuICAgICAgY29uc3QgdGV4dCA9IGl0ZW1zLm1hcCgoaTogYW55KSA9PiBgJHtpLnRpbWUgfHwgJyd9ICR7aS5jdXN0b21lcn0gLSAke2kuc2VydmljZX0gKCR7aS5zdGF0dXN9KWApLmpvaW4oJ1xcbicpIHx8ICdTZW0gY29tcHJvbWlzc29zIHBhcmEgaG9qZS4nXG4gICAgICBjb25zdCByZXMgPSBSZXNwb25zZS5qc29uKHsgcmVwbHk6IHRleHQgfSlcbiAgICAgIGxvZ2dlci5pbmZvKCdhcGlfcmVxdWVzdF9lbmQnLCB7IC4uLmN0eCwgc3RhdHVzOiAyMDAsIGR1cmF0aW9uX21zOiBEYXRlLm5vdygpIC0gc3RhcnQgfSlcbiAgICAgIHJldHVybiByZXNcbiAgICB9XG4gICAgaWYgKHFsb3cuaW5jbHVkZXMoJ2ZhdHVyYXMgZW0gYXRyYXNvJykgfHwgcWxvdy5pbmNsdWRlcygnbGVtYnJldGUgZGUgcGFnYW1lbnRvJykpIHtcbiAgICAgIGNvbnN0IGl0ZW1zID0gYXdhaXQgbGlzdE92ZXJkdWVJbnZvaWNlcyhyZXEpXG4gICAgICBjb25zdCB0ZXh0ID0gaXRlbXMubWFwKChpOiBhbnkpID0+IGAjJHtpLmludm9pY2VfbnVtYmVyfSAke2kuY2xpZW50X25hbWV9IHZlbmNldSBlbSAke25ldyBEYXRlKGkuZHVlX2RhdGUpLnRvTG9jYWxlRGF0ZVN0cmluZygncHQtQlInKX0gKFIkICR7TnVtYmVyKGkudG90YWwgfHwgMCkudG9Mb2NhbGVTdHJpbmcoJ3B0LUJSJyl9KWApLmpvaW4oJ1xcbicpIHx8ICdOZW5odW1hIGZhdHVyYSBlbSBhdHJhc28uJ1xuICAgICAgY29uc3QgcmVzID0gUmVzcG9uc2UuanNvbih7IHJlcGx5OiB0ZXh0IH0pXG4gICAgICBsb2dnZXIuaW5mbygnYXBpX3JlcXVlc3RfZW5kJywgeyAuLi5jdHgsIHN0YXR1czogMjAwLCBkdXJhdGlvbl9tczogRGF0ZS5ub3coKSAtIHN0YXJ0IH0pXG4gICAgICByZXR1cm4gcmVzXG4gICAgfVxuICAgIGNvbnN0IHByb21wdCA9IGJ1aWxkUHJvbXB0KG1lc3NhZ2VzLCBjb250ZXh0LCB1c2VyKVxuICAgIGNvbnN0IGhmID0gYXdhaXQgY2FsbEhGKHByb21wdClcbiAgICBpZiAoaGYpIHtcbiAgICAgIGxvZ2dlci5pbmZvKCdjaGF0Ym90X3N0cmVhbV9zdGFydCcsIGN0eClcbiAgICAgIHJldHVybiBuZXcgUmVzcG9uc2Uoc3RyZWFtVGV4dChoZiksIHsgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ3RleHQvcGxhaW4nIH0gfSlcbiAgICB9XG4gICAgY29uc3QgaCA9IGhldXJpc3RpY1JlcGx5KGNvbnRleHQsIG1lc3NhZ2VzPy5maW5kKChtOiBhbnkpID0+IG0ucm9sZSA9PT0gJ3VzZXInKT8uY29udGVudCB8fCAnJylcbiAgICBjb25zdCByZXMgPSBSZXNwb25zZS5qc29uKGgpXG4gICAgbG9nZ2VyLmluZm8oJ2FwaV9yZXF1ZXN0X2VuZCcsIHsgLi4uY3R4LCBzdGF0dXM6IDIwMCwgZHVyYXRpb25fbXM6IERhdGUubm93KCkgLSBzdGFydCB9KVxuICAgIHJldHVybiByZXNcbiAgfSBjYXRjaCAoZXJyOiBhbnkpIHtcbiAgICBsb2dnZXIuZXJyb3IoJ2NoYXRib3RfZXJyb3InLCB7IC4uLmN0eCwgZXJyOiBlcnI/Lm1lc3NhZ2UgfHwgU3RyaW5nKGVycikgfSlcbiAgICByZXR1cm4gUmVzcG9uc2UuanNvbih7IHJlcGx5OiAnTsOjbyBmb2kgcG9zc8OtdmVsIHJlc3BvbmRlciBhZ29yYS4gVGVudGUgbm92YW1lbnRlLicsIGVycm9yOiB0cnVlIH0sIHsgc3RhdHVzOiAyMDAgfSlcbiAgfVxufVxuIl0sIm5hbWVzIjpbImNhbGxIRiIsImdldEF1dGhVc2VyIiwiZmV0Y2hLcGlzIiwibGlzdEFnZW5kYVRvZGF5IiwibGlzdE92ZXJkdWVJbnZvaWNlcyIsImxvZ2dlciIsImFsbG93IiwiYnVpbGRQcm9tcHQiLCJtZXNzYWdlcyIsImNvbnRleHQiLCJhdXRoVXNlciIsInVzZXJNc2ciLCJmaW5kIiwibSIsInJvbGUiLCJjb250ZW50IiwicGFydHMiLCJwYWdlIiwiU3RyaW5nIiwicHVzaCIsImVtYWlsIiwiaWQiLCJzeXN0ZW0iLCJqb2luIiwiaGV1cmlzdGljUmVwbHkiLCJxdWVzdGlvbiIsInJlcGx5Iiwic3RyZWFtVGV4dCIsInRleHQiLCJlbmNvZGVyIiwiVGV4dEVuY29kZXIiLCJjaHVua3MiLCJtYXRjaCIsIlJlYWRhYmxlU3RyZWFtIiwic3RhcnQiLCJjb250cm9sbGVyIiwiaSIsImRlbGF5IiwibGVuZ3RoIiwiY2xvc2UiLCJlbnF1ZXVlIiwiZW5jb2RlIiwic2V0VGltZW91dCIsIlBPU1QiLCJyZXEiLCJEYXRlIiwibm93IiwiY3R4IiwicmVxdWVzdElkIiwiaGVhZGVycyIsImdldCIsInVuZGVmaW5lZCIsInBhdGgiLCJuZXh0VXJsIiwicGF0aG5hbWUiLCJtZXRob2QiLCJpbmZvIiwiaXAiLCJzcGxpdCIsIndhcm4iLCJSZXNwb25zZSIsImpzb24iLCJzdGF0dXMiLCJib2R5IiwidXNlciIsInFsb3ciLCJ0b0xvd2VyQ2FzZSIsImluY2x1ZGVzIiwia3BpcyIsInRvdGFsQ3VzdG9tZXJzIiwidG90YWxBcHBvaW50bWVudHMiLCJtb250aGx5UmV2ZW51ZSIsInRvTG9jYWxlU3RyaW5nIiwicGVuZGluZ0FwcG9pbnRtZW50cyIsInJlcyIsImR1cmF0aW9uX21zIiwiaXRlbXMiLCJtYXAiLCJ0aW1lIiwiY3VzdG9tZXIiLCJzZXJ2aWNlIiwiaW52b2ljZV9udW1iZXIiLCJjbGllbnRfbmFtZSIsImR1ZV9kYXRlIiwidG9Mb2NhbGVEYXRlU3RyaW5nIiwiTnVtYmVyIiwidG90YWwiLCJwcm9tcHQiLCJoZiIsImgiLCJlcnIiLCJlcnJvciIsIm1lc3NhZ2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/chatbot/assistant/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/ai/provider.ts":
/*!********************************!*\
  !*** ./src/lib/ai/provider.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   callHF: () => (/* binding */ callHF)\n/* harmony export */ });\nconst HF_MODEL = \"https://api-inference.huggingface.co/models/mistralai/Mistral-7B-Instruct-v0.2\";\nasync function callHF(prompt) {\n    const token = process.env.HF_ACCESS_TOKEN;\n    if (!token) return null;\n    const controller = new AbortController();\n    const t = setTimeout(()=>controller.abort(), 15000);\n    const res = await fetch(HF_MODEL, {\n        method: \"POST\",\n        headers: {\n            Authorization: `Bearer ${token}`,\n            \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n            inputs: prompt,\n            parameters: {\n                max_new_tokens: 512,\n                temperature: 0.7,\n                top_p: 0.9\n            }\n        }),\n        signal: controller.signal\n    });\n    clearTimeout(t);\n    if (!res.ok) return null;\n    const data = await res.json();\n    if (Array.isArray(data) && data[0]?.generated_text) return String(data[0].generated_text);\n    if (typeof data === \"string\") return data;\n    return JSON.stringify(data);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2FpL3Byb3ZpZGVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQSxNQUFNQSxXQUFXO0FBRVYsZUFBZUMsT0FBT0MsTUFBYztJQUN6QyxNQUFNQyxRQUFRQyxRQUFRQyxHQUFHLENBQUNDLGVBQWU7SUFDekMsSUFBSSxDQUFDSCxPQUFPLE9BQU87SUFDbkIsTUFBTUksYUFBYSxJQUFJQztJQUN2QixNQUFNQyxJQUFJQyxXQUFXLElBQU1ILFdBQVdJLEtBQUssSUFBSTtJQUMvQyxNQUFNQyxNQUFNLE1BQU1DLE1BQU1iLFVBQVU7UUFDaENjLFFBQVE7UUFDUkMsU0FBUztZQUNQQyxlQUFlLENBQUMsT0FBTyxFQUFFYixNQUFNLENBQUM7WUFDaEMsZ0JBQWdCO1FBQ2xCO1FBQ0FjLE1BQU1DLEtBQUtDLFNBQVMsQ0FBQztZQUFFQyxRQUFRbEI7WUFBUW1CLFlBQVk7Z0JBQUVDLGdCQUFnQjtnQkFBS0MsYUFBYTtnQkFBS0MsT0FBTztZQUFJO1FBQUU7UUFDekdDLFFBQVFsQixXQUFXa0IsTUFBTTtJQUMzQjtJQUNBQyxhQUFhakI7SUFDYixJQUFJLENBQUNHLElBQUllLEVBQUUsRUFBRSxPQUFPO0lBQ3BCLE1BQU1DLE9BQU8sTUFBTWhCLElBQUlpQixJQUFJO0lBQzNCLElBQUlDLE1BQU1DLE9BQU8sQ0FBQ0gsU0FBU0EsSUFBSSxDQUFDLEVBQUUsRUFBRUksZ0JBQWdCLE9BQU9DLE9BQU9MLElBQUksQ0FBQyxFQUFFLENBQUNJLGNBQWM7SUFDeEYsSUFBSSxPQUFPSixTQUFTLFVBQVUsT0FBT0E7SUFDckMsT0FBT1YsS0FBS0MsU0FBUyxDQUFDUztBQUN4QiIsInNvdXJjZXMiOlsid2VicGFjazovL2NybS1jYXNhLWxpbXBhLy4vc3JjL2xpYi9haS9wcm92aWRlci50cz8zYTNmIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IEhGX01PREVMID0gJ2h0dHBzOi8vYXBpLWluZmVyZW5jZS5odWdnaW5nZmFjZS5jby9tb2RlbHMvbWlzdHJhbGFpL01pc3RyYWwtN0ItSW5zdHJ1Y3QtdjAuMidcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNhbGxIRihwcm9tcHQ6IHN0cmluZykge1xuICBjb25zdCB0b2tlbiA9IHByb2Nlc3MuZW52LkhGX0FDQ0VTU19UT0tFTlxuICBpZiAoIXRva2VuKSByZXR1cm4gbnVsbFxuICBjb25zdCBjb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpXG4gIGNvbnN0IHQgPSBzZXRUaW1lb3V0KCgpID0+IGNvbnRyb2xsZXIuYWJvcnQoKSwgMTUwMDApXG4gIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKEhGX01PREVMLCB7XG4gICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgaGVhZGVyczoge1xuICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VufWAsXG4gICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgIH0sXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBpbnB1dHM6IHByb21wdCwgcGFyYW1ldGVyczogeyBtYXhfbmV3X3Rva2VuczogNTEyLCB0ZW1wZXJhdHVyZTogMC43LCB0b3BfcDogMC45IH0gfSksXG4gICAgc2lnbmFsOiBjb250cm9sbGVyLnNpZ25hbCxcbiAgfSlcbiAgY2xlYXJUaW1lb3V0KHQpXG4gIGlmICghcmVzLm9rKSByZXR1cm4gbnVsbFxuICBjb25zdCBkYXRhID0gYXdhaXQgcmVzLmpzb24oKVxuICBpZiAoQXJyYXkuaXNBcnJheShkYXRhKSAmJiBkYXRhWzBdPy5nZW5lcmF0ZWRfdGV4dCkgcmV0dXJuIFN0cmluZyhkYXRhWzBdLmdlbmVyYXRlZF90ZXh0KVxuICBpZiAodHlwZW9mIGRhdGEgPT09ICdzdHJpbmcnKSByZXR1cm4gZGF0YVxuICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoZGF0YSlcbn1cbiJdLCJuYW1lcyI6WyJIRl9NT0RFTCIsImNhbGxIRiIsInByb21wdCIsInRva2VuIiwicHJvY2VzcyIsImVudiIsIkhGX0FDQ0VTU19UT0tFTiIsImNvbnRyb2xsZXIiLCJBYm9ydENvbnRyb2xsZXIiLCJ0Iiwic2V0VGltZW91dCIsImFib3J0IiwicmVzIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwiQXV0aG9yaXphdGlvbiIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiaW5wdXRzIiwicGFyYW1ldGVycyIsIm1heF9uZXdfdG9rZW5zIiwidGVtcGVyYXR1cmUiLCJ0b3BfcCIsInNpZ25hbCIsImNsZWFyVGltZW91dCIsIm9rIiwiZGF0YSIsImpzb24iLCJBcnJheSIsImlzQXJyYXkiLCJnZW5lcmF0ZWRfdGV4dCIsIlN0cmluZyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/ai/provider.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/logger.ts":
/*!***************************!*\
  !*** ./src/lib/logger.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   logger: () => (/* binding */ logger)\n/* harmony export */ });\nconst ORDER = {\n    debug: 10,\n    info: 20,\n    warn: 30,\n    error: 40\n};\nconst ENV = \"development\" || 0;\nconst NAME = process.env.SERVICE_NAME || \"crm-casa-limpa\";\nconst LEVEL = process.env.LOG_LEVEL || (ENV === \"production\" ? \"info\" : \"debug\");\nconst PRETTY = process.env.LOG_FORMAT === \"pretty\";\nfunction emit(level, msg, extra) {\n    if (ORDER[level] < ORDER[LEVEL]) return;\n    const base = {\n        ts: new Date().toISOString(),\n        level,\n        env: ENV,\n        service: NAME,\n        msg,\n        ...extra || {}\n    };\n    if (PRETTY) {\n        const line = `[${base.ts}] ${level.toUpperCase()} ${base.msg} ${JSON.stringify(extra || {})}`;\n        if (level === \"error\") console.error(line);\n        else if (level === \"warn\") console.warn(line);\n        else console.log(line);\n    } else {\n        const line = JSON.stringify(base);\n        if (level === \"error\") console.error(line);\n        else if (level === \"warn\") console.warn(line);\n        else console.log(line);\n    }\n}\nconst logger = {\n    debug: (msg, extra)=>emit(\"debug\", msg, extra),\n    info: (msg, extra)=>emit(\"info\", msg, extra),\n    warn: (msg, extra)=>emit(\"warn\", msg, extra),\n    error: (msg, extra)=>emit(\"error\", msg, extra)\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2xvZ2dlci50cyIsIm1hcHBpbmdzIjoiOzs7O0FBQ0EsTUFBTUEsUUFBK0I7SUFBRUMsT0FBTztJQUFJQyxNQUFNO0lBQUlDLE1BQU07SUFBSUMsT0FBTztBQUFHO0FBQ2hGLE1BQU1DLE1BQU1DLGlCQUF3QjtBQUNwQyxNQUFNQyxPQUFPRCxRQUFRRSxHQUFHLENBQUNDLFlBQVksSUFBSTtBQUN6QyxNQUFNQyxRQUFRLFFBQVNGLEdBQUcsQ0FBQ0csU0FBUyxJQUFlTixDQUFBQSxRQUFRLGVBQWUsU0FBUyxPQUFNO0FBQ3pGLE1BQU1PLFNBQVNOLFFBQVFFLEdBQUcsQ0FBQ0ssVUFBVSxLQUFLO0FBRTFDLFNBQVNDLEtBQUtDLEtBQVksRUFBRUMsR0FBVyxFQUFFQyxLQUEyQjtJQUNsRSxJQUFJakIsS0FBSyxDQUFDZSxNQUFNLEdBQUdmLEtBQUssQ0FBQ1UsTUFBTSxFQUFFO0lBQ2pDLE1BQU1RLE9BQU87UUFBRUMsSUFBSSxJQUFJQyxPQUFPQyxXQUFXO1FBQUlOO1FBQU9QLEtBQUtIO1FBQUtpQixTQUFTZjtRQUFNUztRQUFLLEdBQUlDLFNBQVMsQ0FBQyxDQUFDO0lBQUU7SUFDbkcsSUFBSUwsUUFBUTtRQUNWLE1BQU1XLE9BQU8sQ0FBQyxDQUFDLEVBQUVMLEtBQUtDLEVBQUUsQ0FBQyxFQUFFLEVBQUVKLE1BQU1TLFdBQVcsR0FBRyxDQUFDLEVBQUVOLEtBQUtGLEdBQUcsQ0FBQyxDQUFDLEVBQUVTLEtBQUtDLFNBQVMsQ0FBQ1QsU0FBUyxDQUFDLEdBQUcsQ0FBQztRQUM3RixJQUFJRixVQUFVLFNBQVNZLFFBQVF2QixLQUFLLENBQUNtQjthQUNoQyxJQUFJUixVQUFVLFFBQVFZLFFBQVF4QixJQUFJLENBQUNvQjthQUNuQ0ksUUFBUUMsR0FBRyxDQUFDTDtJQUNuQixPQUFPO1FBQ0wsTUFBTUEsT0FBT0UsS0FBS0MsU0FBUyxDQUFDUjtRQUM1QixJQUFJSCxVQUFVLFNBQVNZLFFBQVF2QixLQUFLLENBQUNtQjthQUNoQyxJQUFJUixVQUFVLFFBQVFZLFFBQVF4QixJQUFJLENBQUNvQjthQUNuQ0ksUUFBUUMsR0FBRyxDQUFDTDtJQUNuQjtBQUNGO0FBRU8sTUFBTU0sU0FBUztJQUNwQjVCLE9BQU8sQ0FBQ2UsS0FBYUMsUUFBZ0NILEtBQUssU0FBU0UsS0FBS0M7SUFDeEVmLE1BQU0sQ0FBQ2MsS0FBYUMsUUFBZ0NILEtBQUssUUFBUUUsS0FBS0M7SUFDdEVkLE1BQU0sQ0FBQ2EsS0FBYUMsUUFBZ0NILEtBQUssUUFBUUUsS0FBS0M7SUFDdEViLE9BQU8sQ0FBQ1ksS0FBYUMsUUFBZ0NILEtBQUssU0FBU0UsS0FBS0M7QUFDMUUsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL2NybS1jYXNhLWxpbXBhLy4vc3JjL2xpYi9sb2dnZXIudHM/YjQ5ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJ0eXBlIExldmVsID0gJ2RlYnVnJyB8ICdpbmZvJyB8ICd3YXJuJyB8ICdlcnJvcidcbmNvbnN0IE9SREVSOiBSZWNvcmQ8TGV2ZWwsIG51bWJlcj4gPSB7IGRlYnVnOiAxMCwgaW5mbzogMjAsIHdhcm46IDMwLCBlcnJvcjogNDAgfVxuY29uc3QgRU5WID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgfHwgJ2RldmVsb3BtZW50J1xuY29uc3QgTkFNRSA9IHByb2Nlc3MuZW52LlNFUlZJQ0VfTkFNRSB8fCAnY3JtLWNhc2EtbGltcGEnXG5jb25zdCBMRVZFTCA9IChwcm9jZXNzLmVudi5MT0dfTEVWRUwgYXMgTGV2ZWwpIHx8IChFTlYgPT09ICdwcm9kdWN0aW9uJyA/ICdpbmZvJyA6ICdkZWJ1ZycpXG5jb25zdCBQUkVUVFkgPSBwcm9jZXNzLmVudi5MT0dfRk9STUFUID09PSAncHJldHR5J1xuXG5mdW5jdGlvbiBlbWl0KGxldmVsOiBMZXZlbCwgbXNnOiBzdHJpbmcsIGV4dHJhPzogUmVjb3JkPHN0cmluZywgYW55Pikge1xuICBpZiAoT1JERVJbbGV2ZWxdIDwgT1JERVJbTEVWRUxdKSByZXR1cm5cbiAgY29uc3QgYmFzZSA9IHsgdHM6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwgbGV2ZWwsIGVudjogRU5WLCBzZXJ2aWNlOiBOQU1FLCBtc2csIC4uLihleHRyYSB8fCB7fSkgfVxuICBpZiAoUFJFVFRZKSB7XG4gICAgY29uc3QgbGluZSA9IGBbJHtiYXNlLnRzfV0gJHtsZXZlbC50b1VwcGVyQ2FzZSgpfSAke2Jhc2UubXNnfSAke0pTT04uc3RyaW5naWZ5KGV4dHJhIHx8IHt9KX1gXG4gICAgaWYgKGxldmVsID09PSAnZXJyb3InKSBjb25zb2xlLmVycm9yKGxpbmUpXG4gICAgZWxzZSBpZiAobGV2ZWwgPT09ICd3YXJuJykgY29uc29sZS53YXJuKGxpbmUpXG4gICAgZWxzZSBjb25zb2xlLmxvZyhsaW5lKVxuICB9IGVsc2Uge1xuICAgIGNvbnN0IGxpbmUgPSBKU09OLnN0cmluZ2lmeShiYXNlKVxuICAgIGlmIChsZXZlbCA9PT0gJ2Vycm9yJykgY29uc29sZS5lcnJvcihsaW5lKVxuICAgIGVsc2UgaWYgKGxldmVsID09PSAnd2FybicpIGNvbnNvbGUud2FybihsaW5lKVxuICAgIGVsc2UgY29uc29sZS5sb2cobGluZSlcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgbG9nZ2VyID0ge1xuICBkZWJ1ZzogKG1zZzogc3RyaW5nLCBleHRyYT86IFJlY29yZDxzdHJpbmcsIGFueT4pID0+IGVtaXQoJ2RlYnVnJywgbXNnLCBleHRyYSksXG4gIGluZm86IChtc2c6IHN0cmluZywgZXh0cmE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+KSA9PiBlbWl0KCdpbmZvJywgbXNnLCBleHRyYSksXG4gIHdhcm46IChtc2c6IHN0cmluZywgZXh0cmE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+KSA9PiBlbWl0KCd3YXJuJywgbXNnLCBleHRyYSksXG4gIGVycm9yOiAobXNnOiBzdHJpbmcsIGV4dHJhPzogUmVjb3JkPHN0cmluZywgYW55PikgPT4gZW1pdCgnZXJyb3InLCBtc2csIGV4dHJhKSxcbn1cblxuZXhwb3J0IHR5cGUgTG9nQ3R4ID0geyByZXF1ZXN0SWQ/OiBzdHJpbmc7IHVzZXJJZD86IHN0cmluZzsgcGF0aD86IHN0cmluZzsgbWV0aG9kPzogc3RyaW5nOyBzdGF0dXM/OiBudW1iZXI7IGR1cmF0aW9uX21zPzogbnVtYmVyIH1cblxuIl0sIm5hbWVzIjpbIk9SREVSIiwiZGVidWciLCJpbmZvIiwid2FybiIsImVycm9yIiwiRU5WIiwicHJvY2VzcyIsIk5BTUUiLCJlbnYiLCJTRVJWSUNFX05BTUUiLCJMRVZFTCIsIkxPR19MRVZFTCIsIlBSRVRUWSIsIkxPR19GT1JNQVQiLCJlbWl0IiwibGV2ZWwiLCJtc2ciLCJleHRyYSIsImJhc2UiLCJ0cyIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsInNlcnZpY2UiLCJsaW5lIiwidG9VcHBlckNhc2UiLCJKU09OIiwic3RyaW5naWZ5IiwiY29uc29sZSIsImxvZyIsImxvZ2dlciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/logger.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/ratelimit.ts":
/*!******************************!*\
  !*** ./src/lib/ratelimit.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   allow: () => (/* binding */ allow)\n/* harmony export */ });\nconst g = globalThis;\ng.__rl = g.__rl || new Map();\nfunction allow(ip, key, limit, windowMs) {\n    const id = `${ip || \"unknown\"}:${key}`;\n    const now = Date.now();\n    const e = g.__rl.get(id);\n    if (!e || e.resetAt < now) {\n        g.__rl.set(id, {\n            count: 1,\n            resetAt: now + windowMs\n        });\n        return true;\n    }\n    if (e.count < limit) {\n        e.count += 1;\n        return true;\n    }\n    return false;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3JhdGVsaW1pdC50cyIsIm1hcHBpbmdzIjoiOzs7O0FBQ0EsTUFBTUEsSUFBSUM7QUFDVkQsRUFBRUUsSUFBSSxHQUFHRixFQUFFRSxJQUFJLElBQUksSUFBSUM7QUFFaEIsU0FBU0MsTUFBTUMsRUFBaUIsRUFBRUMsR0FBVyxFQUFFQyxLQUFhLEVBQUVDLFFBQWdCO0lBQ25GLE1BQU1DLEtBQUssQ0FBQyxFQUFFSixNQUFNLFVBQVUsQ0FBQyxFQUFFQyxJQUFJLENBQUM7SUFDdEMsTUFBTUksTUFBTUMsS0FBS0QsR0FBRztJQUNwQixNQUFNRSxJQUFJWixFQUFFRSxJQUFJLENBQUNXLEdBQUcsQ0FBQ0o7SUFDckIsSUFBSSxDQUFDRyxLQUFLQSxFQUFFRSxPQUFPLEdBQUdKLEtBQUs7UUFDekJWLEVBQUVFLElBQUksQ0FBQ2EsR0FBRyxDQUFDTixJQUFJO1lBQUVPLE9BQU87WUFBR0YsU0FBU0osTUFBTUY7UUFBUztRQUNuRCxPQUFPO0lBQ1Q7SUFDQSxJQUFJSSxFQUFFSSxLQUFLLEdBQUdULE9BQU87UUFDbkJLLEVBQUVJLEtBQUssSUFBSTtRQUNYLE9BQU87SUFDVDtJQUNBLE9BQU87QUFDVCIsInNvdXJjZXMiOlsid2VicGFjazovL2NybS1jYXNhLWxpbXBhLy4vc3JjL2xpYi9yYXRlbGltaXQudHM/YTJiZSJdLCJzb3VyY2VzQ29udGVudCI6WyJ0eXBlIEVudHJ5ID0geyBjb3VudDogbnVtYmVyOyByZXNldEF0OiBudW1iZXIgfVxuY29uc3QgZyA9IGdsb2JhbFRoaXMgYXMgYW55XG5nLl9fcmwgPSBnLl9fcmwgfHwgbmV3IE1hcDxzdHJpbmcsIEVudHJ5PigpXG5cbmV4cG9ydCBmdW5jdGlvbiBhbGxvdyhpcDogc3RyaW5nIHwgbnVsbCwga2V5OiBzdHJpbmcsIGxpbWl0OiBudW1iZXIsIHdpbmRvd01zOiBudW1iZXIpIHtcbiAgY29uc3QgaWQgPSBgJHtpcCB8fCAndW5rbm93bid9OiR7a2V5fWBcbiAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKVxuICBjb25zdCBlID0gZy5fX3JsLmdldChpZCkgYXMgRW50cnkgfCB1bmRlZmluZWRcbiAgaWYgKCFlIHx8IGUucmVzZXRBdCA8IG5vdykge1xuICAgIGcuX19ybC5zZXQoaWQsIHsgY291bnQ6IDEsIHJlc2V0QXQ6IG5vdyArIHdpbmRvd01zIH0pXG4gICAgcmV0dXJuIHRydWVcbiAgfVxuICBpZiAoZS5jb3VudCA8IGxpbWl0KSB7XG4gICAgZS5jb3VudCArPSAxXG4gICAgcmV0dXJuIHRydWVcbiAgfVxuICByZXR1cm4gZmFsc2Vcbn1cbiJdLCJuYW1lcyI6WyJnIiwiZ2xvYmFsVGhpcyIsIl9fcmwiLCJNYXAiLCJhbGxvdyIsImlwIiwia2V5IiwibGltaXQiLCJ3aW5kb3dNcyIsImlkIiwibm93IiwiRGF0ZSIsImUiLCJnZXQiLCJyZXNldEF0Iiwic2V0IiwiY291bnQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/ratelimit.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/supabaseServer.ts":
/*!***********************************!*\
  !*** ./src/lib/supabaseServer.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getAuthUser: () => (/* binding */ getAuthUser),\n/* harmony export */   getServerSupabase: () => (/* binding */ getServerSupabase)\n/* harmony export */ });\n/* harmony import */ var _supabase_ssr__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/ssr */ \"(rsc)/./node_modules/@supabase/ssr/dist/module/index.js\");\n\nfunction getServerSupabase(request) {\n    const supabase = (0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_0__.createServerClient)(\"https://hyygforlvwbbdzpctnid.supabase.co\", \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh5eWdmb3JsdndiYmR6cGN0bmlkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMyNjY1NjksImV4cCI6MjA3ODg0MjU2OX0.1ih4fZRYRzg1oqZxAYonDPi5wO2-DHvb7anjcSPWeqs\", {\n        cookies: {\n            getAll () {\n                return request.cookies.getAll();\n            },\n            setAll (cookiesToSet) {\n                cookiesToSet.forEach(({ name, value })=>request.cookies.set(name, value));\n            }\n        }\n    });\n    return supabase;\n}\nasync function getAuthUser(request) {\n    const supabase = getServerSupabase(request);\n    const { data: { user } } = await supabase.auth.getUser();\n    return {\n        supabase,\n        user\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3N1cGFiYXNlU2VydmVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFrRDtBQUczQyxTQUFTQyxrQkFBa0JDLE9BQW9CO0lBQ3BELE1BQU1DLFdBQVdILGlFQUFrQkEsQ0FDakNJLDBDQUFvQyxFQUNwQ0Esa05BQXlDLEVBQ3pDO1FBQ0VJLFNBQVM7WUFDUEM7Z0JBQ0UsT0FBT1AsUUFBUU0sT0FBTyxDQUFDQyxNQUFNO1lBQy9CO1lBQ0FDLFFBQU9DLFlBQThEO2dCQUNuRUEsYUFBYUMsT0FBTyxDQUFDLENBQUMsRUFBRUMsSUFBSSxFQUFFQyxLQUFLLEVBQUUsR0FBS1osUUFBUU0sT0FBTyxDQUFDTyxHQUFHLENBQUNGLE1BQU1DO1lBQ3RFO1FBQ0Y7SUFDRjtJQUVGLE9BQU9YO0FBQ1Q7QUFFTyxlQUFlYSxZQUFZZCxPQUFvQjtJQUNwRCxNQUFNQyxXQUFXRixrQkFBa0JDO0lBQ25DLE1BQU0sRUFBRWUsTUFBTSxFQUFFQyxJQUFJLEVBQUUsRUFBRSxHQUFHLE1BQU1mLFNBQVNnQixJQUFJLENBQUNDLE9BQU87SUFDdEQsT0FBTztRQUFFakI7UUFBVWU7SUFBSztBQUMxQiIsInNvdXJjZXMiOlsid2VicGFjazovL2NybS1jYXNhLWxpbXBhLy4vc3JjL2xpYi9zdXBhYmFzZVNlcnZlci50cz8xYjMyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZVNlcnZlckNsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9zc3InXG5pbXBvcnQgeyBOZXh0UmVxdWVzdCB9IGZyb20gJ25leHQvc2VydmVyJ1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2VydmVyU3VwYWJhc2UocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVTZXJ2ZXJDbGllbnQoXG4gICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMISxcbiAgICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSEsXG4gICAge1xuICAgICAgY29va2llczoge1xuICAgICAgICBnZXRBbGwoKSB7XG4gICAgICAgICAgcmV0dXJuIHJlcXVlc3QuY29va2llcy5nZXRBbGwoKVxuICAgICAgICB9LFxuICAgICAgICBzZXRBbGwoY29va2llc1RvU2V0OiB7IG5hbWU6IHN0cmluZzsgdmFsdWU6IHN0cmluZzsgb3B0aW9ucz86IGFueSB9W10pIHtcbiAgICAgICAgICBjb29raWVzVG9TZXQuZm9yRWFjaCgoeyBuYW1lLCB2YWx1ZSB9KSA9PiByZXF1ZXN0LmNvb2tpZXMuc2V0KG5hbWUsIHZhbHVlKSlcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfVxuICApXG4gIHJldHVybiBzdXBhYmFzZVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QXV0aFVzZXIocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTZXJ2ZXJTdXBhYmFzZShyZXF1ZXN0KVxuICBjb25zdCB7IGRhdGE6IHsgdXNlciB9IH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLmdldFVzZXIoKVxuICByZXR1cm4geyBzdXBhYmFzZSwgdXNlciB9XG59XG4iXSwibmFtZXMiOlsiY3JlYXRlU2VydmVyQ2xpZW50IiwiZ2V0U2VydmVyU3VwYWJhc2UiLCJyZXF1ZXN0Iiwic3VwYWJhc2UiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkiLCJjb29raWVzIiwiZ2V0QWxsIiwic2V0QWxsIiwiY29va2llc1RvU2V0IiwiZm9yRWFjaCIsIm5hbWUiLCJ2YWx1ZSIsInNldCIsImdldEF1dGhVc2VyIiwiZGF0YSIsInVzZXIiLCJhdXRoIiwiZ2V0VXNlciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/supabaseServer.ts\n");

/***/ }),

/***/ "(rsc)/./src/server/chat/tools.ts":
/*!**********************************!*\
  !*** ./src/server/chat/tools.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createClient: () => (/* binding */ createClient),\n/* harmony export */   fetchKpis: () => (/* binding */ fetchKpis),\n/* harmony export */   listAgendaToday: () => (/* binding */ listAgendaToday),\n/* harmony export */   listOverdueInvoices: () => (/* binding */ listOverdueInvoices),\n/* harmony export */   scheduleJob: () => (/* binding */ scheduleJob),\n/* harmony export */   withAuth: () => (/* binding */ withAuth)\n/* harmony export */ });\n/* harmony import */ var _lib_supabaseServer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/supabaseServer */ \"(rsc)/./src/lib/supabaseServer.ts\");\n\nasync function withAuth(request) {\n    const { supabase, user } = await (0,_lib_supabaseServer__WEBPACK_IMPORTED_MODULE_0__.getAuthUser)(request);\n    if (!user) throw new Error(\"N\\xe3o autenticado\");\n    return {\n        supabase,\n        user\n    };\n}\nasync function fetchKpis(request) {\n    const { supabase } = await withAuth(request);\n    const { data: customers } = await supabase.from(\"customers\").select(\"id\");\n    const { data: appointments } = await supabase.from(\"appointments\").select(\"id, status, appointment_date, price\");\n    const currentMonth = new Date().toISOString().slice(0, 7);\n    const monthlyRevenue = (appointments || []).filter((a)=>a.status === \"completed\" && String(a.appointment_date || \"\").startsWith(currentMonth)).reduce((sum, a)=>sum + Number(a.price || 0), 0);\n    const pendingAppointments = (appointments || []).filter((a)=>[\n            \"scheduled\",\n            \"confirmed\"\n        ].includes(a.status)).length;\n    return {\n        totalCustomers: (customers || []).length,\n        totalAppointments: (appointments || []).length,\n        monthlyRevenue,\n        pendingAppointments\n    };\n}\nasync function listAgendaToday(request) {\n    const { supabase } = await withAuth(request);\n    const today = new Date().toISOString().slice(0, 10);\n    const { data, error } = await supabase.from(\"appointments\").select(\"id, appointment_date, appointment_time, status, customers(name), services(name)\").eq(\"appointment_date\", today);\n    if (error) throw error;\n    return (data || []).map((a)=>({\n            id: a.id,\n            date: a.appointment_date,\n            time: a.appointment_time,\n            status: a.status,\n            customer: a.customers?.name || \"\",\n            service: a.services?.name || \"\"\n        }));\n}\nasync function createClient(request, payload) {\n    const { supabase } = await withAuth(request);\n    const base = {\n        name: payload.name,\n        phone: payload.phone || null,\n        email: payload.email || null\n    };\n    const { data, error } = await supabase.from(\"customers\").insert([\n        base\n    ]).select(\"*\").single();\n    if (error) throw error;\n    return data;\n}\nasync function scheduleJob(request, payload) {\n    const { supabase } = await withAuth(request);\n    const base = {\n        customer_id: payload.customer_id,\n        service_id: payload.service_id,\n        appointment_date: payload.date,\n        appointment_time: payload.time || null,\n        status: \"scheduled\"\n    };\n    const { data, error } = await supabase.from(\"appointments\").insert([\n        base\n    ]).select(\"*\").single();\n    if (error) throw error;\n    return data;\n}\nasync function listOverdueInvoices(request) {\n    const { supabase } = await withAuth(request);\n    const today = new Date().toISOString().slice(0, 10);\n    const { data, error } = await supabase.from(\"invoices\").select(\"id, invoice_number, client_id, due_date, status, total, customers(name, email)\").lt(\"due_date\", today).neq(\"status\", \"paid\");\n    if (error) throw error;\n    return (data || []).map((i)=>({\n            id: i.id,\n            invoice_number: i.invoice_number,\n            client_id: i.client_id,\n            due_date: i.due_date,\n            total: i.total,\n            client_name: i.customers?.name || \"\",\n            client_email: i.customers?.email || \"\"\n        }));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UTtZQUFJc0IsY0FBY04sRUFBRWxELFNBQVMsRUFBRXlDLFNBQVM7UUFBRztBQUNoTyIsInNvdXJjZXMiOlsid2VicGFjazovL2NybS1jYXNhLWxpbXBhLy4vc3JjL3NlcnZlci9jaGF0L3Rvb2xzLnRzPzM2NjkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QgfSBmcm9tICduZXh0L3NlcnZlcidcbmltcG9ydCB7IGdldFNlcnZlclN1cGFiYXNlLCBnZXRBdXRoVXNlciB9IGZyb20gJ0AvbGliL3N1cGFiYXNlU2VydmVyJ1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gd2l0aEF1dGgocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgY29uc3QgeyBzdXBhYmFzZSwgdXNlciB9ID0gYXdhaXQgZ2V0QXV0aFVzZXIocmVxdWVzdClcbiAgaWYgKCF1c2VyKSB0aHJvdyBuZXcgRXJyb3IoJ07Do28gYXV0ZW50aWNhZG8nKVxuICByZXR1cm4geyBzdXBhYmFzZSwgdXNlciB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmZXRjaEtwaXMocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgY29uc3QgeyBzdXBhYmFzZSB9ID0gYXdhaXQgd2l0aEF1dGgocmVxdWVzdClcbiAgY29uc3QgeyBkYXRhOiBjdXN0b21lcnMgfSA9IGF3YWl0IHN1cGFiYXNlLmZyb20oJ2N1c3RvbWVycycpLnNlbGVjdCgnaWQnKVxuICBjb25zdCB7IGRhdGE6IGFwcG9pbnRtZW50cyB9ID0gYXdhaXQgc3VwYWJhc2UuZnJvbSgnYXBwb2ludG1lbnRzJykuc2VsZWN0KCdpZCwgc3RhdHVzLCBhcHBvaW50bWVudF9kYXRlLCBwcmljZScpXG4gIGNvbnN0IGN1cnJlbnRNb250aCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zbGljZSgwLCA3KVxuICBjb25zdCBtb250aGx5UmV2ZW51ZSA9IChhcHBvaW50bWVudHMgfHwgW10pXG4gICAgLmZpbHRlcigoYTogYW55KSA9PiBhLnN0YXR1cyA9PT0gJ2NvbXBsZXRlZCcgJiYgU3RyaW5nKGEuYXBwb2ludG1lbnRfZGF0ZSB8fCAnJykuc3RhcnRzV2l0aChjdXJyZW50TW9udGgpKVxuICAgIC5yZWR1Y2UoKHN1bTogbnVtYmVyLCBhOiBhbnkpID0+IHN1bSArIE51bWJlcihhLnByaWNlIHx8IDApLCAwKVxuICBjb25zdCBwZW5kaW5nQXBwb2ludG1lbnRzID0gKGFwcG9pbnRtZW50cyB8fCBbXSkuZmlsdGVyKChhOiBhbnkpID0+IFsnc2NoZWR1bGVkJywgJ2NvbmZpcm1lZCddLmluY2x1ZGVzKGEuc3RhdHVzKSkubGVuZ3RoXG4gIHJldHVybiB7XG4gICAgdG90YWxDdXN0b21lcnM6IChjdXN0b21lcnMgfHwgW10pLmxlbmd0aCxcbiAgICB0b3RhbEFwcG9pbnRtZW50czogKGFwcG9pbnRtZW50cyB8fCBbXSkubGVuZ3RoLFxuICAgIG1vbnRobHlSZXZlbnVlLFxuICAgIHBlbmRpbmdBcHBvaW50bWVudHMsXG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxpc3RBZ2VuZGFUb2RheShyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICBjb25zdCB7IHN1cGFiYXNlIH0gPSBhd2FpdCB3aXRoQXV0aChyZXF1ZXN0KVxuICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zbGljZSgwLCAxMClcbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAuZnJvbSgnYXBwb2ludG1lbnRzJylcbiAgICAuc2VsZWN0KCdpZCwgYXBwb2ludG1lbnRfZGF0ZSwgYXBwb2ludG1lbnRfdGltZSwgc3RhdHVzLCBjdXN0b21lcnMobmFtZSksIHNlcnZpY2VzKG5hbWUpJylcbiAgICAuZXEoJ2FwcG9pbnRtZW50X2RhdGUnLCB0b2RheSkgYXMgYW55XG4gIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcbiAgcmV0dXJuIChkYXRhIHx8IFtdKS5tYXAoKGE6IGFueSkgPT4gKHtcbiAgICBpZDogYS5pZCxcbiAgICBkYXRlOiBhLmFwcG9pbnRtZW50X2RhdGUsXG4gICAgdGltZTogYS5hcHBvaW50bWVudF90aW1lLFxuICAgIHN0YXR1czogYS5zdGF0dXMsXG4gICAgY3VzdG9tZXI6IGEuY3VzdG9tZXJzPy5uYW1lIHx8ICcnLFxuICAgIHNlcnZpY2U6IGEuc2VydmljZXM/Lm5hbWUgfHwgJycsXG4gIH0pKVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlQ2xpZW50KHJlcXVlc3Q6IE5leHRSZXF1ZXN0LCBwYXlsb2FkOiB7IG5hbWU6IHN0cmluZzsgcGhvbmU/OiBzdHJpbmcgfCBudWxsOyBlbWFpbD86IHN0cmluZyB8IG51bGwgfSkge1xuICBjb25zdCB7IHN1cGFiYXNlIH0gPSBhd2FpdCB3aXRoQXV0aChyZXF1ZXN0KVxuICBjb25zdCBiYXNlID0geyBuYW1lOiBwYXlsb2FkLm5hbWUsIHBob25lOiBwYXlsb2FkLnBob25lIHx8IG51bGwsIGVtYWlsOiBwYXlsb2FkLmVtYWlsIHx8IG51bGwgfVxuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5mcm9tKCdjdXN0b21lcnMnKS5pbnNlcnQoW2Jhc2VdKS5zZWxlY3QoJyonKS5zaW5nbGUoKVxuICBpZiAoZXJyb3IpIHRocm93IGVycm9yXG4gIHJldHVybiBkYXRhXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzY2hlZHVsZUpvYihyZXF1ZXN0OiBOZXh0UmVxdWVzdCwgcGF5bG9hZDogeyBjdXN0b21lcl9pZDogc3RyaW5nOyBzZXJ2aWNlX2lkOiBzdHJpbmc7IGRhdGU6IHN0cmluZzsgdGltZT86IHN0cmluZyB8IG51bGwgfSkge1xuICBjb25zdCB7IHN1cGFiYXNlIH0gPSBhd2FpdCB3aXRoQXV0aChyZXF1ZXN0KVxuICBjb25zdCBiYXNlID0geyBjdXN0b21lcl9pZDogcGF5bG9hZC5jdXN0b21lcl9pZCwgc2VydmljZV9pZDogcGF5bG9hZC5zZXJ2aWNlX2lkLCBhcHBvaW50bWVudF9kYXRlOiBwYXlsb2FkLmRhdGUsIGFwcG9pbnRtZW50X3RpbWU6IHBheWxvYWQudGltZSB8fCBudWxsLCBzdGF0dXM6ICdzY2hlZHVsZWQnIH1cbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UuZnJvbSgnYXBwb2ludG1lbnRzJykuaW5zZXJ0KFtiYXNlXSkuc2VsZWN0KCcqJykuc2luZ2xlKClcbiAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxuICByZXR1cm4gZGF0YVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbGlzdE92ZXJkdWVJbnZvaWNlcyhyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICBjb25zdCB7IHN1cGFiYXNlIH0gPSBhd2FpdCB3aXRoQXV0aChyZXF1ZXN0KVxuICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zbGljZSgwLCAxMClcbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAuZnJvbSgnaW52b2ljZXMnKVxuICAgIC5zZWxlY3QoJ2lkLCBpbnZvaWNlX251bWJlciwgY2xpZW50X2lkLCBkdWVfZGF0ZSwgc3RhdHVzLCB0b3RhbCwgY3VzdG9tZXJzKG5hbWUsIGVtYWlsKScpXG4gICAgLmx0KCdkdWVfZGF0ZScsIHRvZGF5KVxuICAgIC5uZXEoJ3N0YXR1cycsICdwYWlkJykgYXMgYW55XG4gIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcbiAgcmV0dXJuIChkYXRhIHx8IFtdKS5tYXAoKGk6IGFueSkgPT4gKHsgaWQ6IGkuaWQsIGludm9pY2VfbnVtYmVyOiBpLmludm9pY2VfbnVtYmVyLCBjbGllbnRfaWQ6IGkuY2xpZW50X2lkLCBkdWVfZGF0ZTogaS5kdWVfZGF0ZSwgdG90YWw6IGkudG90YWwsIGNsaWVudF9uYW1lOiBpLmN1c3RvbWVycz8ubmFtZSB8fCAnJywgY2xpZW50X2VtYWlsOiBpLmN1c3RvbWVycz8uZW1haWwgfHwgJycgfSkpXG59XG5cbiJdLCJuYW1lcyI6WyJnZXRBdXRoVXNlciIsIndpdGhBdXRoIiwicmVxdWVzdCIsInN1cGFiYXNlIiwidXNlciIsIkVycm9yIiwiZmV0Y2hLcGlzIiwiZGF0YSIsImN1c3RvbWVycyIsImZyb20iLCJzZWxlY3QiLCJhcHBvaW50bWVudHMiLCJjdXJyZW50TW9udGgiLCJEYXRlIiwidG9JU09TdHJpbmciLCJzbGljZSIsIm1vbnRobHlSZXZlbnVlIiwiZmlsdGVyIiwiYSIsInN0YXR1cyIsIlN0cmluZyIsImFwcG9pbnRtZW50X2RhdGUiLCJzdGFydHNXaXRoIiwicmVkdWNlIiwic3VtIiwiTnVtYmVyIiwicHJpY2UiLCJwZW5kaW5nQXBwb2ludG1lbnRzIiwiaW5jbHVkZXMiLCJsZW5ndGgiLCJ0b3RhbEN1c3RvbWVycyIsInRvdGFsQXBwb2ludG1lbnRzIiwibGlzdEFnZW5kYVRvZGF5IiwidG9kYXkiLCJlcnJvciIsImVxIiwibWFwIiwiaWQiLCJkYXRlIiwidGltZSIsImFwcG9pbnRtZW50X3RpbWUiLCJjdXN0b21lciIsIm5hbWUiLCJzZXJ2aWNlIiwic2VydmljZXMiLCJjcmVhdGVDbGllbnQiLCJwYXlsb2FkIiwiYmFzZSIsInBob25lIiwiZW1haWwiLCJpbnNlcnQiLCJzaW5nbGUiLCJzY2hlZHVsZUpvYiIsImN1c3RvbWVyX2lkIiwic2VydmljZV9pZCIsImxpc3RPdmVyZHVlSW52b2ljZXMiLCJsdCIsIm5lcSIsImkiLCJpbnZvaWNlX251bWJlciIsImNsaWVudF9pZCIsImR1ZV9kYXRlIiwidG90YWwiLCJjbGllbnRfbmFtZSIsImNsaWVudF9lbWFpbCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/server/chat/tools.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/@supabase","vendor-chunks/next","vendor-chunks/tslib","vendor-chunks/cookie"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchatbot%2Fassistant%2Froute&page=%2Fapi%2Fchatbot%2Fassistant%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchatbot%2Fassistant%2Froute.ts&appDir=C%3A%5CUsers%5CEnzo%20Marcelo%5CDesktop%5Ctestes%20SOLO%20TRAE%5Ccrm%20casa%20limpa%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CEnzo%20Marcelo%5CDesktop%5Ctestes%20SOLO%20TRAE%5Ccrm%20casa%20limpa&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();