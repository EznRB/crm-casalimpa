"use strict";(()=>{var e={};e.id=385,e.ids=[385],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3869:(e,t,i)=>{i.r(t),i.d(t,{originalPathname:()=>h,patchFetch:()=>v,requestAsyncStorage:()=>d,routeModule:()=>u,serverHooks:()=>l,staticGenerationAsyncStorage:()=>m});var r={};i.r(r),i.d(r,{GET:()=>c});var n=i(9303),s=i(8716),a=i(670),o=i(7070),p=i(748);async function c(e,{params:t}){let{supabase:i,user:r}=await (0,p.n)(e);if(!r)return o.NextResponse.json({error:"N\xe3o autenticado"},{status:401});let{searchParams:n}=new URL(e.url),s=n.get("month"),a=i.from("appointments").select("id, appointment_date, appointment_time, status, price, service_id, services(name)").eq("customer_id",t.id);s&&(a=a.like("appointment_date",`${s}%`));let{data:c,error:u}=await a;if(u)return o.NextResponse.json({error:u.message},{status:400});let d=function(e,t){let i=e.join(","),r=t.map(t=>e.map(e=>JSON.stringify(t[e]??"")).join(",")).join("\n");return`${i}
${r}`}(["id","date","appointment_time","service","status","total"],(c??[]).map(e=>({id:e.id,date:e.appointment_date,appointment_time:e.appointment_time,service:e.services?.name??"",status:e.status,total:`R$ ${Number(e.price).toFixed(2)}`})));return new o.NextResponse(d,{headers:{"Content-Type":"text/csv; charset=utf-8","Content-Disposition":`attachment; filename="relatorio-cliente-${t.id}.csv"`}})}let u=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/reports/client/[id]/route",pathname:"/api/reports/client/[id]",filename:"route",bundlePath:"app/api/reports/client/[id]/route"},resolvedPagePath:"C:\\Users\\Enzo Marcelo\\Desktop\\testes SOLO TRAE\\crm casa limpa\\src\\app\\api\\reports\\client\\[id]\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:d,staticGenerationAsyncStorage:m,serverHooks:l}=u,h="/api/reports/client/[id]/route";function v(){return(0,a.patchFetch)({serverHooks:l,staticGenerationAsyncStorage:m})}},748:(e,t,i)=>{i.d(t,{n:()=>n});var r=i(2305);async function n(e){let t=(0,r.createServerClient)("https://hyygforlvwbbdzpctnid.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh5eWdmb3JsdndiYmR6cGN0bmlkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMyNjY1NjksImV4cCI6MjA3ODg0MjU2OX0.1ih4fZRYRzg1oqZxAYonDPi5wO2-DHvb7anjcSPWeqs",{cookies:{getAll:()=>e.cookies.getAll(),setAll(t){t.forEach(({name:t,value:i})=>e.cookies.set(t,i))}}}),{data:{user:i}}=await t.auth.getUser();return{supabase:t,user:i}}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var i=e=>t(t.s=e),r=t.X(0,[8948,5972,2305],()=>i(3869));module.exports=r})();