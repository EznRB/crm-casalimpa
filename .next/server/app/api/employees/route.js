"use strict";(()=>{var e={};e.id=5572,e.ids=[5572],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4239:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>g,patchFetch:()=>w,requestAsyncStorage:()=>m,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>f});var o={};r.r(o),r.d(o,{GET:()=>l,POST:()=>c});var s=r(9303),n=r(8716),a=r(670),i=r(7070),p=r(748),u=r(3895);async function l(e){let t=Date.now(),r={requestId:e.headers.get("x-request-id")||void 0,path:e.nextUrl.pathname,method:e.method};u.k.info("api_request_start",r);let{supabase:o,user:s}=await (0,p.n)(e);if(!s)return u.k.warn("not_authenticated",r),i.NextResponse.json({error:"N\xe3o autenticado"},{status:401});let{data:n,error:a}=await o.from("employees").select("*").order("name",{ascending:!0});if(a)return u.k.error("employees_list_failed",{...r,err:a.message}),i.NextResponse.json({error:"Erro ao buscar funcion\xe1rios"},{status:500});let l=i.NextResponse.json(n??[]);return u.k.info("api_request_end",{...r,status:l.status,duration_ms:Date.now()-t}),l}async function c(e){let t=Date.now(),r={requestId:e.headers.get("x-request-id")||void 0,path:e.nextUrl.pathname,method:e.method};u.k.info("api_request_start",r);let{supabase:o,user:s}=await (0,p.n)(e);if(!s)return u.k.warn("not_authenticated",r),i.NextResponse.json({error:"N\xe3o autenticado"},{status:401});try{let s=await e.json(),n=String(s.cpf??"").replace(/\D/g,""),{data:a,error:p}=await o.from("employees").select("id").eq("cpf",n).limit(1);if(p)throw p;if(a&&a.length>0){let e=i.NextResponse.json({error:"CPF j\xe1 cadastrado para outro funcion\xe1rio"},{status:409});return u.k.warn("employees_duplicate_cpf",{...r,status:e.status}),e}let{data:l,error:c}=await o.from("employees").insert([{name:s.name,email:s.email??null,phone:s.phone,cpf:n,position:s.position??"Funcion\xe1rio",dailyRate:150,notes:s.notes??null,active:s.active??!0}]).select("*").single();if(c)throw c;let d=i.NextResponse.json(l,{status:201});return u.k.info("api_request_end",{...r,status:d.status,duration_ms:Date.now()-t}),d}catch(e){return u.k.error("employees_create_failed",{...r,err:e?.message||String(e)}),i.NextResponse.json({error:"Erro ao criar funcion\xe1rio"},{status:500})}}let d=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/employees/route",pathname:"/api/employees",filename:"route",bundlePath:"app/api/employees/route"},resolvedPagePath:"C:\\Users\\Enzo Marcelo\\Desktop\\testes SOLO TRAE\\crm casa limpa\\src\\app\\api\\employees\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:m,staticGenerationAsyncStorage:f,serverHooks:h}=d,g="/api/employees/route";function w(){return(0,a.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:f})}},3895:(e,t,r)=>{r.d(t,{k:()=>p});let o={debug:10,info:20,warn:30,error:40},s=process.env.SERVICE_NAME||"crm-casa-limpa",n=process.env.LOG_LEVEL||"info",a="pretty"===process.env.LOG_FORMAT;function i(e,t,r){if(o[e]<o[n])return;let i={ts:new Date().toISOString(),level:e,env:"production",service:s,msg:t,...r||{}};if(a){let t=`[${i.ts}] ${e.toUpperCase()} ${i.msg} ${JSON.stringify(r||{})}`;"error"===e?console.error(t):"warn"===e?console.warn(t):console.log(t)}else{let t=JSON.stringify(i);"error"===e?console.error(t):"warn"===e?console.warn(t):console.log(t)}}let p={debug:(e,t)=>i("debug",e,t),info:(e,t)=>i("info",e,t),warn:(e,t)=>i("warn",e,t),error:(e,t)=>i("error",e,t)}},748:(e,t,r)=>{r.d(t,{n:()=>s});var o=r(2305);async function s(e){let t=(0,o.createServerClient)("https://hyygforlvwbbdzpctnid.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh5eWdmb3JsdndiYmR6cGN0bmlkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMyNjY1NjksImV4cCI6MjA3ODg0MjU2OX0.1ih4fZRYRzg1oqZxAYonDPi5wO2-DHvb7anjcSPWeqs",{cookies:{getAll:()=>e.cookies.getAll(),setAll(t){t.forEach(({name:t,value:r})=>e.cookies.set(t,r))}}}),{data:{user:r}}=await t.auth.getUser();return{supabase:t,user:r}}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[8948,5972,2305],()=>r(4239));module.exports=o})();